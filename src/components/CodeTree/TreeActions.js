import $ from 'jquery'
import jstree from 'jstree';

let source = {"tree":[{"text":"cloud","state":{"opened":true},"type":"folder","children":[{"text":"app.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9yZWdlbmVyYXRvciA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3InKTsKCnZhciBfcmVnZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVnZW5lcmF0b3IpOwoKdmFyIF9wYXRoID0gcmVxdWlyZSgncGF0aCcpOwoKdmFyIF9wYXRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhdGgpOwoKdmFyIF9ib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTsKCnZhciBfYm9keVBhcnNlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ib2R5UGFyc2VyKTsKCnZhciBfY29va2llUGFyc2VyID0gcmVxdWlyZSgnY29va2llLXBhcnNlcicpOwoKdmFyIF9jb29raWVQYXJzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29va2llUGFyc2VyKTsKCnZhciBfY28gPSByZXF1aXJlKCdjbycpOwoKdmFyIF9jbzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbyk7Cgp2YXIgX2dldEI0YVVzZXJzID0gcmVxdWlyZSgnLi9saWIvZ2V0QjRhVXNlcnMnKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgphcHAuc2V0KCd2aWV3cycsIF9wYXRoMi5kZWZhdWx0LmpvaW4oX19kaXJuYW1lLCAndmlld3MnKSk7CmFwcC5zZXQoJ3ZpZXcgZW5naW5lJywgJ2VqcycpOwoKYXBwLnVzZShfYm9keVBhcnNlcjIuZGVmYXVsdC51cmxlbmNvZGVkKHsKICBleHRlbmRlZDogZmFsc2UKfSkpOwoKYXBwLnVzZShfYm9keVBhcnNlcjIuZGVmYXVsdC5qc29uKCkpOwoKYXBwLnVzZSgoMCwgX2Nvb2tpZVBhcnNlcjIuZGVmYXVsdCkoKSk7CgphcHAuZ2V0KCcvJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgKDAsIF9jbzIuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgdmFyIHV0bV9jYW1wYWlnbnMsIHV0bV9zb3VyY2VzLCB1dG1fdGVybXMsIHV0bV9tZWRpdW1zLCB1dG1fY29udGVudHM7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gKDAsIF9nZXRCNGFVc2Vycy5nZXREaXN0aW5jdENhbXBhaWducykoKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHV0bV9jYW1wYWlnbnMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QjRhVXNlcnMuZ2V0RGlzdGluY3RTb3VyY2VzKSgpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgdXRtX3NvdXJjZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QjRhVXNlcnMuZ2V0RGlzdGluY3RUZXJtcykoKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIHV0bV90ZXJtcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QjRhVXNlcnMuZ2V0RGlzdGluY3RNZWRpdW1zKSgpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIHV0bV9tZWRpdW1zID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICByZXR1cm4gKDAsIF9nZXRCNGFVc2Vycy5nZXREaXN0aW5jdENvbnRlbnRzKSgpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIHV0bV9jb250ZW50cyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICB1dG1fY2FtcGFpZ25zID0gdXRtX2NhbXBhaWducy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHV0bV9zb3VyY2VzID0gdXRtX3NvdXJjZXMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB1dG1fdGVybXMgPSB1dG1fdGVybXMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB1dG1fbWVkaXVtcyA9IHV0bV9tZWRpdW1zLmZpbHRlcihmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdXRtX2NvbnRlbnRzID0gdXRtX2NvbnRlbnRzLmZpbHRlcihmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgncmV0dXJuJywgeyB1dG1fY2FtcGFpZ25zOiB1dG1fY2FtcGFpZ25zLCB1dG1fc291cmNlczogdXRtX3NvdXJjZXMsIHV0bV90ZXJtczogdXRtX3Rlcm1zLCB1dG1fbWVkaXVtczogdXRtX21lZGl1bXMsIHV0bV9jb250ZW50czogdXRtX2NvbnRlbnRzIH0pOwoKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICBjYXNlICdlbmQnOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgfSkpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgcmVzLnJlbmRlcignaW5kZXgnLCByZXN1bHQpOwogIH0pOwp9KTsKCmFwcC5nZXQoJy9yZXBvcnQnLCBmdW5jdGlvbiAocmVxLCByZXMpIHsKICBQYXJzZS5DbG91ZC5ydW4oJ3JlcG9ydCcsIHJlcS5xdWVyeSkudGhlbihmdW5jdGlvbiAocmVwb3J0KSB7CiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXBvcnQpOwogIH0pOwp9KTs="}},{"text":"checkoutIntegration.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9tb25nb2RiID0gcmVxdWlyZSgnbW9uZ29kYicpOwoKdmFyIF9tb25nb2RiMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21vbmdvZGIpOwoKdmFyIF9jaGVja291dCA9IHJlcXVpcmUoJy4vdXRpbC9jaGVja291dCcpOwoKdmFyIGNoZWNrb3V0ID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX2NoZWNrb3V0KTsKCnZhciBfZGIyID0gcmVxdWlyZSgnLi91dGlsL2RiJyk7Cgp2YXIgZGIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfZGIyKTsKCnZhciBfc2V0dGluZ3MgPSByZXF1aXJlKCcuL3NldHRpbmdzJyk7Cgp2YXIgX3NldHRpbmdzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NldHRpbmdzKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIFN1YnNjcmlwdGlvbiA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ1N1YnNjcmlwdGlvbicpOwp2YXIgQjRhVXNlciA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ0I0YVVzZXInKTsKClBhcnNlLkNsb3VkLmRlZmluZSgnYWRkU3Vic2NyaXB0aW9uJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgdmFyIGdhdGV3YXkgPSByZXEucGFyYW1zWydnYXRld2F5J107CiAgdmFyIGdhdGV3YXlDb2RlID0gcmVxLnBhcmFtc1snZ2F0ZXdheV9jb2RlJ107CiAgdmFyIGdhdGV3YXlFbWFpbCA9IHJlcS5wYXJhbXNbJ2dhdGV3YXlfZW1haWwnXTsKICB2YXIgaW5pdGlhbERhdGUgPSByZXEucGFyYW1zWydpbml0aWFsX2RhdGUnXTsKICB2YXIgYXBwSWQgPSByZXEucGFyYW1zWydhcHBfaWQnXTsKICB2YXIgcGxhbk5hbWUgPSByZXEucGFyYW1zWydwbGFuX25hbWUnXTsKICB2YXIgY2hlY2tvdXRJZCA9IHJlcS5wYXJhbXNbJ2NoZWNrb3V0X2lkJ107CgogIHZhciBzdWJzID0gbmV3IFN1YnNjcmlwdGlvbih7CiAgICBnYXRld2F5OiBnYXRld2F5LAogICAgZ2F0ZXdheV9jb2RlOiBnYXRld2F5Q29kZSwKICAgIGdhdGV3YXlfZW1haWw6IGdhdGV3YXlFbWFpbCwKICAgIGFwcF9pZHM6IFthcHBJZF0sCiAgICBjaGVja291dF9pZDogY2hlY2tvdXRJZCwKICAgIGluaXRpYWxfZGF0ZTogbmV3IERhdGUoaW5pdGlhbERhdGUpCiAgfSk7CgogIHJldHVybiBjaGVja291dC5nZXRQbGFucygpLnRoZW4oZnVuY3Rpb24gKHBsYW5zKSB7CiAgICByZXR1cm4gc3Vicy5zYXZlKCkudGhlbihmdW5jdGlvbiAoc3VicykgewogICAgICByZXR1cm4gZ2V0T3duZXIoYXBwSWQpLnRoZW4oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgdXNlciA9IF9yZWYudXNlciwKICAgICAgICAgICAgdXNlcklkID0gX3JlZi51c2VySWQ7CgogICAgICAgIGlmICh1c2VyKSBzdWJzLnNldCgndXNlcicsIHVzZXIpOwogICAgICAgIGlmICh1c2VySWQpIHN1YnMuc2V0KCd1c2VyX2lkJywgdXNlcklkKTsKICAgICAgICBzdWJzLnNldCgndmFsdWUnLCBwbGFuc1twbGFuTmFtZV0pOwogICAgICAgIHJldHVybiBzdWJzLnNhdmUoKTsKICAgICAgfSk7CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgcmVzLnN1Y2Nlc3MoJ3N1YnNjcmlwdGlvbiBzYXZlZCBmb3IgJyArIGFwcElkKTsKICAgIH0pOwogIH0pOwp9KTsKCmZ1bmN0aW9uIGdldE93bmVyKGFwcElkKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oX3NldHRpbmdzMi5kZWZhdWx0Lk1PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiKSB7CiAgICByZXR1cm4gX2RiLmNvbGxlY3Rpb24oJ1BhcnNlQXBwJywgeyByZWFkUHJlZmVyZW5jZTogX21vbmdvZGIyLmRlZmF1bHQuU0VDT05EQVJZX1BSRUZFUlJFRCB9KS5maW5kKHsKICAgICAgYXBwSWQ6IGFwcElkCiAgICB9KS50b0FycmF5KCkudGhlbihmdW5jdGlvbiAoYXBwcykgewogICAgICBpZiAoYXBwcyAmJiBhcHBzWzBdKSB7CiAgICAgICAgdmFyIGFwcCA9IGFwcHNbMF07CiAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KEI0YVVzZXIpOwogICAgICAgIHF1ZXJ5LmVxdWFsVG8oJ2ludGVybmFsX2lkJywgYXBwLm93bmVyLmlkKTsKICAgICAgICByZXR1cm4gcXVlcnkuZmlyc3QoeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSkudGhlbihmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdXNlcjogdXNlciwKICAgICAgICAgICAgdXNlcklkOiBhcHAub3duZXIuaWQKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogIH0pOwp9"}},{"text":"dailyJobs.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9wcm9taXNlID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UnKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfcmVnZW5lcmF0b3IgPSByZXF1aXJlKCdiYWJlbC1ydW50aW1lL3JlZ2VuZXJhdG9yJyk7Cgp2YXIgX3JlZ2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlZ2VuZXJhdG9yKTsKCnZhciBfa2V5cyA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cycpOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKdmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yJyk7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXN5bmNUb0dlbmVyYXRvcjIpOwoKdmFyIF9nZXRDcmVhdGVkQXBwcyA9IHJlcXVpcmUoJy4vbGliL2dldENyZWF0ZWRBcHBzJyk7Cgp2YXIgX2dldENyZWF0ZWRBcHBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldENyZWF0ZWRBcHBzKTsKCnZhciBfZ2V0Q3JlYXRlZFBsYW5zID0gcmVxdWlyZSgnLi9saWIvZ2V0Q3JlYXRlZFBsYW5zJyk7Cgp2YXIgX2dldENyZWF0ZWRQbGFuczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRDcmVhdGVkUGxhbnMpOwoKdmFyIF9nZXRBY3RpdmVBcHBzID0gcmVxdWlyZSgnLi9saWIvZ2V0QWN0aXZlQXBwcycpOwoKdmFyIF9nZXRBY3RpdmVBcHBzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldEFjdGl2ZUFwcHMpOwoKdmFyIF9nZXRBcHBzUGVyVXNlciA9IHJlcXVpcmUoJy4vbGliL2dldEFwcHNQZXJVc2VyJyk7Cgp2YXIgX2dldEFwcHNQZXJVc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldEFwcHNQZXJVc2VyKTsKCnZhciBfZ2V0QjRhVXNlcnMgPSByZXF1aXJlKCcuL2xpYi9nZXRCNGFVc2VycycpOwoKdmFyIF9nZXRCNGFVc2VyczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRCNGFVc2Vycyk7Cgp2YXIgX2dldEFQSUNhbGxzID0gcmVxdWlyZSgnLi9saWIvZ2V0QVBJQ2FsbHMnKTsKCnZhciBfZ2V0QVBJQ2FsbHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0QVBJQ2FsbHMpOwoKdmFyIF9nZXRBbmFseXRpY3NEYXRhID0gcmVxdWlyZSgnLi9saWIvZ2V0QW5hbHl0aWNzRGF0YScpOwoKdmFyIF9nZXRBbmFseXRpY3NEYXRhMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldEFuYWx5dGljc0RhdGEpOwoKdmFyIF9nZXRSZXBvcnREYWlseVVzZXIgPSByZXF1aXJlKCcuL2xpYi9nZXRSZXBvcnREYWlseVVzZXInKTsKCnZhciBfZ2V0UmVwb3J0RGFpbHlVc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFJlcG9ydERhaWx5VXNlcik7Cgp2YXIgX3F1ZXJ5RGF0ZXMgPSByZXF1aXJlKCcuL3V0aWwvcXVlcnlEYXRlcycpOwoKdmFyIHF1ZXJ5RGF0ZXMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfcXVlcnlEYXRlcyk7Cgp2YXIgX25vZGVBZHdvcmRzID0gcmVxdWlyZSgnbm9kZS1hZHdvcmRzJyk7Cgp2YXIgX21vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpOwoKdmFyIF9tb21lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbW9tZW50KTsKCnZhciBfY3N2dG9qc29uID0gcmVxdWlyZSgnY3N2dG9qc29uJyk7Cgp2YXIgX2NzdnRvanNvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jc3Z0b2pzb24pOwoKdmFyIF9jbyA9IHJlcXVpcmUoJ2NvJyk7Cgp2YXIgX2NvMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvKTsKCnZhciBfY3J5cHRvVXRpbHMgPSByZXF1aXJlKCdwYXJzZS1zZXJ2ZXIvbGliL2NyeXB0b1V0aWxzJyk7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfQoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBSZXBvcnREYWlseUdlbmVyYWwgPSBQYXJzZS5PYmplY3QuZXh0ZW5kKCdSZXBvcnRfRGFpbHlfR2VuZXJhbCcpOwp2YXIgQjRhVXNlciA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ0I0YVVzZXInKTsKdmFyIGRhdGVGb3JtYXQgPSAnZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzIFtHTVQrMDAwMCAoVVRDKV0nOwoKLyoqCiAqIENsb3VkIENvZGUgSm9iCiAqIFRoaXMgZnVuY3Rpb24gc2F2ZXMgdGhlIERhaWx5IEdlbmVyYWwgZGF0YS4KICogSXQgZ2V0cyBUb3RhbCBhbmQgTmV3IEFwcHMgYW5kIFBsYW5zLiBBbHNvLCBBY3RpdmUgVXNlcnMgYW5kIEFwcHMuCiAqIEBmdW5jdGlvbiBoZWxsbwogKiBAYWxpYXMgaGVsbG8KICogQGV4YW1wbGUgUE9TVCAvZnVuY3Rpb25zL2hlbGxvICJ7fSIKICovCgp2YXIgc2F2ZURhaWx5R2VuZXJhbCA9IGZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjMuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlcSwgcmVzKSB7CiAgICB2YXIgcmVmZXJlbmNlRGF0ZSwgcGVyVXNlcnMsIHJlcG9ydCwgYXBwc0NyZWF0ZWRQZXJVc2VyLCBwbGFuc0NyZWF0ZWRQZXJVc2VyLCBhY3RpdmVVc2VycywgYXBpQ2FsbHNQZXJVc2VyLCB5ZXN0ZXJkYXksIHRvZGF5LCBlbmREYXRlLCBhV2Vla0FnbywgcmVwb3J0QnVsaywgcXVlcnksIGdldERhaWx5R2VuZXJhbCwgZ2V0RGFpbHlVc2VyLCBnZXRVc2Vyc1JlY3Vyc2l2ZWx5LCBnZXRDcmVhdGVkVXNlcnMsIGdldFBhc3Q7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGdldFBhc3QgPSBmdW5jdGlvbiBnZXRQYXN0KGRhdGUpIHsKICAgICAgICAgICAgICB2YXIgYmVmb3JlID0gbmV3IERhdGUoZGF0ZSk7CiAgICAgICAgICAgICAgYmVmb3JlLnNldEhvdXJzKC0yNCk7CiAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KFJlcG9ydERhaWx5R2VuZXJhbCk7CiAgICAgICAgICAgICAgcXVlcnkuZXF1YWxUbygncmVmZXJlbmNlX2RhdGUnLCBiZWZvcmUpOwogICAgICAgICAgICAgIHJldHVybiBxdWVyeS5maW5kKHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UGFzdChiZWZvcmUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgeWVzdGVyZGF5ID0gYmVmb3JlOwogICAgICAgICAgICAgICAgICByZWZlcmVuY2VEYXRlID0gcXVlcnlEYXRlcy5nZXREYXRlU3RyaW5nKHllc3RlcmRheSk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDYWxjdWxhdGluZyBQYXN0OiAnICsgcmVmZXJlbmNlRGF0ZSk7CiAgICAgICAgICAgICAgICAgIHJlcy5zdWNjZXNzKCdzdWNjZXNzJyk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBnZXREYWlseUdlbmVyYWwoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICByZXMuZXJyb3IoZSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBnZXRDcmVhdGVkVXNlcnMgPSBmdW5jdGlvbiBnZXRDcmVhdGVkVXNlcnMoYmVnaW5EYXRlLCBlbmREYXRlKSB7CiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9OwogICAgICAgICAgICAgIHZhciBxdWVyeSA9IG5ldyBQYXJzZS5RdWVyeShCNGFVc2VyKTsKICAgICAgICAgICAgICBxdWVyeS5ncmVhdGVyVGhhbk9yRXF1YWxUbygnb3JpZ2luYWxfY3JlYXRlZF9hdCcsIGJlZ2luRGF0ZSk7CiAgICAgICAgICAgICAgcXVlcnkubGVzc1RoYW4oJ29yaWdpbmFsX2NyZWF0ZWRfYXQnLCBlbmREYXRlKTsKICAgICAgICAgICAgICByZXR1cm4gcXVlcnkuY291bnQoeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSkudGhlbihmdW5jdGlvbiAoY291bnQpIHsKICAgICAgICAgICAgICAgIHJlc3VsdC5uZXdVc2VycyA9IGNvdW50OwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KEI0YVVzZXIpOwogICAgICAgICAgICAgICAgcXVlcnkubGVzc1RoYW4oJ29yaWdpbmFsX2NyZWF0ZWRfYXQnLCBlbmREYXRlKTsKICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeS5jb3VudCh7IHVzZU1hc3RlcktleTogdHJ1ZSB9KTsKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjb3VudCkgewogICAgICAgICAgICAgICAgcmVzdWx0LnRvdGFsVXNlcnMgPSBjb3VudDsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBnZXRVc2Vyc1JlY3Vyc2l2ZWx5ID0gZnVuY3Rpb24gZ2V0VXNlcnNSZWN1cnNpdmVseSgpIHsKICAgICAgICAgICAgICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDsKCiAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KEI0YVVzZXIpOwogICAgICAgICAgICAgIHZhciBwYWNpbmcgPSA1MDA7CiAgICAgICAgICAgICAgcXVlcnkubGltaXQocGFjaW5nKTsKICAgICAgICAgICAgICBxdWVyeS5za2lwKHBhY2luZyAqIGkpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwYWNpbmcgJyArIHBhY2luZyAqIGkpOwogICAgICAgICAgICAgIHJldHVybiBxdWVyeS5maW5kKHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdHNbMF0gPyByZXN1bHRzWzBdLmdldCgnaW50ZXJuYWxfaWQnKSA6ICdzaGl0Jyk7CiAgICAgICAgICAgICAgICB2YXIgdXNlcklkcyA9IHJlc3VsdHMubWFwKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyLmdldCgnaW50ZXJuYWxfaWQnKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QXBwc1BlclVzZXIyLmRlZmF1bHQpKHVzZXJJZHMsIHRvZGF5KS50aGVuKGZ1bmN0aW9uIChfcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIHZhciB0b3RhbHMgPSBfcmVzdWx0LnBlclVzZXI7CiAgICAgICAgICAgICAgICAgIGlmICgoMCwgX2tleXMyLmRlZmF1bHQpKHRvdGFscykubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHByb21pc2VzID0gcmVzdWx0cy5tYXAoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSB1c2VyLmdldCgnaW50ZXJuYWxfaWQnKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBub3cgPSAoMCwgX21vbWVudDIuZGVmYXVsdCkoKS51dGMoKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBub3dTdHIgPSBub3cuZm9ybWF0KGRhdGVGb3JtYXQpOwogICAgICAgICAgICAgICAgICAgICAgcmVwb3J0QnVsay5maW5kKHsgdXNlcjogdXNlciwgcmVmZXJlbmNlX2RhdGU6IHllc3RlcmRheSB9KS51cHNlcnQoKS51cGRhdGVPbmUoewogICAgICAgICAgICAgICAgICAgICAgICAkc2V0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX3BfdXNlcjogJ0I0YVVzZXIkJyArIHVzZXIuaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlX2FwcHM6IGFjdGl2ZVVzZXJzW3VzZXJJZF0gfHwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfcGxhbnM6IHBsYW5zQ3JlYXRlZFBlclVzZXJbdXNlcklkXSB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19hcHBzOiBhcHBzQ3JlYXRlZFBlclVzZXJbdXNlcklkXSB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgIGFwcHNfdG90YWw6IHRvdGFsc1t1c2VySWRdID8gdG90YWxzW3VzZXJJZF0uYXBwcyB8fCAwIDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFuc190b3RhbDogdG90YWxzW3VzZXJJZF0gPyB0b3RhbHNbdXNlcklkXS5wbGFucyB8fCAwIDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICBhcGlfY2FsbHM6IGFwaUNhbGxzUGVyVXNlclt1c2VySWRdID8gYXBpQ2FsbHNQZXJVc2VyW3VzZXJJZF0gfHwgMCA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBub3dTdHIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgJHNldE9uSW5zZXJ0OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiAoMCwgX2NyeXB0b1V0aWxzLm5ld09iamVjdElkKSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgIF9wX3VzZXI6ICdCNGFVc2VyJCcgKyB1c2VyLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZV9kYXRlOiB5ZXN0ZXJkYXksCiAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBub3dTdHIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBhcnNlLlByb21pc2Uud2hlbihwcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VXNlcnNSZWN1cnNpdmVseShpKTsKICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChjb25zb2xlLmVycm9yKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgZ2V0RGFpbHlVc2VyID0gZnVuY3Rpb24gZ2V0RGFpbHlVc2VyKCkgewogICAgICAgICAgICAgIHJldHVybiBnZXRVc2Vyc1JlY3Vyc2l2ZWx5KCk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBnZXREYWlseUdlbmVyYWwgPSBmdW5jdGlvbiBnZXREYWlseUdlbmVyYWwoKSB7CiAgICAgICAgICAgICAgdG9kYXkgPSBuZXcgRGF0ZSh5ZXN0ZXJkYXkpOwogICAgICAgICAgICAgIHRvZGF5LnNldFVUQ0RhdGUodG9kYXkuZ2V0VVRDRGF0ZSgpICsgMSk7CiAgICAgICAgICAgICAgYVdlZWtBZ28gPSBuZXcgRGF0ZSh0b2RheSk7CiAgICAgICAgICAgICAgYVdlZWtBZ28uc2V0VVRDRGF0ZShhV2Vla0Fnby5nZXRVVENEYXRlKCkgLSA3KTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhhV2Vla0Fnbyk7CiAgICAgICAgICAgICAgZW5kRGF0ZSA9IHF1ZXJ5RGF0ZXMuZ2V0RGF0ZVN0cmluZyh0b2RheSk7CiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVmZXJlbmNlRGF0ZSwgZW5kRGF0ZSk7CiAgICAgICAgICAgICAgcmVwb3J0LnNldCgncmVmZXJlbmNlX2RhdGUnLCB5ZXN0ZXJkYXkpOwogICAgICAgICAgICAgIHJldHVybiAoMCwgX2dldENyZWF0ZWRBcHBzMi5kZWZhdWx0KShudWxsLCB7IGVuZERhdGU6IGVuZERhdGUsIHBlclVzZXJzOiBwZXJVc2VycyB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFswXTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRDcmVhdGVkQXBwcyAnICsgKDAsIF9rZXlzMi5kZWZhdWx0KShyZXN1bHQucGVyVXNlcikubGVuZ3RoKTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ3N0YXR1cycsICdzdGFydGVkJyk7CiAgICAgICAgICAgICAgICByZXBvcnQuc2V0KCduZXdfYXBwcycsIHJlc3VsdC5jcmVhdGVkQXBwcyk7CiAgICAgICAgICAgICAgICByZXBvcnQuc2V0KCdhcHBzX3RvdGFsJywgcmVzdWx0LmFwcHNUb3RhbFBlcmlvZCk7CiAgICAgICAgICAgICAgICBhcHBzQ3JlYXRlZFBlclVzZXIgPSByZXN1bHQucGVyVXNlcjsKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2dldENyZWF0ZWRQbGFuczIuZGVmYXVsdCkobnVsbCwgeyBlbmREYXRlOiBlbmREYXRlLCBwZXJVc2VyczogcGVyVXNlcnMgfSk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbMF07CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ2V0Q3JlYXRlZFBsYW5zICcgKyAoMCwgX2tleXMyLmRlZmF1bHQpKHJlc3VsdC5wZXJVc2VyKS5sZW5ndGgpOwogICAgICAgICAgICAgICAgcmVwb3J0LnNldCgnbmV3X3BsYW5zJywgcmVzdWx0LmNyZWF0ZWRQbGFucyB8fCAwKTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ3BsYW5zX3RvdGFsJywgcmVzdWx0LnBsYW5zVG90YWxQZXJpb2QpOwogICAgICAgICAgICAgICAgcGxhbnNDcmVhdGVkUGVyVXNlciA9IHJlc3VsdC5wZXJVc2VyOwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QW5hbHl0aWNzRGF0YTIuZGVmYXVsdCkocmVmZXJlbmNlRGF0ZSk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ2V0QW5hbHl0aWNzRGF0YSAnICsgcmVzdWx0KTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ3Nlc3Npb25zJywgTnVtYmVyKHJlc3VsdFswXSkpOwogICAgICAgICAgICAgICAgcmVwb3J0LnNldCgnbmV3X3Nlc3Npb25zJywgTnVtYmVyKHJlc3VsdFsxXSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlcG9ydC5zYXZlKG51bGwsIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pOwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGdldENyZWF0ZWRVc2Vycyh5ZXN0ZXJkYXksIHRvZGF5KTsKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRDcmVhdGVkVXNlcnMgJyArIHJlc3VsdCk7CiAgICAgICAgICAgICAgICByZXBvcnQuc2V0KCduZXdfdXNlcnMnLCByZXN1bHQubmV3VXNlcnMpOwogICAgICAgICAgICAgICAgcmVwb3J0LnNldCgndXNlcnNfdG90YWwnLCByZXN1bHQudG90YWxVc2Vycyk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVwb3J0LnNhdmUobnVsbCwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9nZXRBY3RpdmVBcHBzMi5kZWZhdWx0KShudWxsLCB7CiAgICAgICAgICAgICAgICAgIGJlZ2luRGF0ZTogcXVlcnlEYXRlcy5nZXREYXRlU3RyaW5nKGFXZWVrQWdvKSwKICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogZW5kRGF0ZSwgcGVyVXNlcnM6IHBlclVzZXJzCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFswXTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRBY3RpdmVBcHBzICcgKyAoMCwgX2tleXMyLmRlZmF1bHQpKHJlc3VsdC5wZXJVc2VycykubGVuZ3RoKTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ2FjdGl2ZV9hcHBzJywgcmVzdWx0LmFjdGl2ZUFwcHMpOwogICAgICAgICAgICAgICAgcmVwb3J0LnNldCgnYWN0aXZlX3VzZXJzJywgcmVzdWx0LmFjdGl2ZVVzZXJzKTsKICAgICAgICAgICAgICAgIGFjdGl2ZVVzZXJzID0gcmVzdWx0LnBlclVzZXJzOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlcG9ydC5zYXZlKG51bGwsIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pOwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuICgwLCBfZ2V0QVBJQ2FsbHMyLmRlZmF1bHQpKG51bGwsIHsKICAgICAgICAgICAgICAgICAgYmVnaW5EYXRlOiByZWZlcmVuY2VEYXRlLAogICAgICAgICAgICAgICAgICBlbmREYXRlOiBlbmREYXRlLCBwZXJVc2VyczogcGVyVXNlcnMKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0WzBdOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dldEFQSUNhbGxzICcgKyAoMCwgX2tleXMyLmRlZmF1bHQpKHJlc3VsdC5wZXJVc2VycykubGVuZ3RoKTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ2FwaV9jYWxscycsIHJlc3VsdC5hcGlDYWxscyk7CiAgICAgICAgICAgICAgICBhcGlDYWxsc1BlclVzZXIgPSByZXN1bHQucGVyVXNlcnM7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVwb3J0LnNhdmUobnVsbCwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RGFpbHlVc2VyKCk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXBvcnRCdWxrLmV4ZWN1dGUoKTsKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ3N0YXR1cycsICdmaW5pc2hlZCcpOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlcG9ydC5zYXZlKG51bGwsIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pOwogICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIHJlcG9ydC5zZXQoJ3N0YXR1cycsICdlcnJvcmVkJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVwb3J0LnNhdmUobnVsbCwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSk7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgcmVwb3J0LnNldCgnc3RhdHVzJywgJ2Vycm9yZWQnKTsKICAgICAgICAgICAgICAgIHJldHVybiByZXBvcnQuc2F2ZShudWxsLCB7IHVzZU1hc3RlcktleTogdHJ1ZSB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHJlZmVyZW5jZURhdGUgPSByZXEucGFyYW1zLnJlZmVyZW5jZURhdGU7CiAgICAgICAgICAgIHBlclVzZXJzID0gdHJ1ZTsKICAgICAgICAgICAgcmVwb3J0ID0gbmV3IFJlcG9ydERhaWx5R2VuZXJhbCgpOwogICAgICAgICAgICBhcHBzQ3JlYXRlZFBlclVzZXIgPSB2b2lkIDAsIHBsYW5zQ3JlYXRlZFBlclVzZXIgPSB2b2lkIDAsIGFjdGl2ZVVzZXJzID0gdm9pZCAwLCBhcGlDYWxsc1BlclVzZXIgPSB2b2lkIDA7CiAgICAgICAgICAgIHllc3RlcmRheSA9IHZvaWQgMCwgdG9kYXkgPSB2b2lkIDAsIGVuZERhdGUgPSB2b2lkIDAsIGFXZWVrQWdvID0gdm9pZCAwOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgIHJldHVybiBfZ2V0UmVwb3J0RGFpbHlVc2VyMi5kZWZhdWx0LmdldFVub3JkZXJlZEJ1bGsoKTsKCiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICByZXBvcnRCdWxrID0gX2NvbnRleHQuc2VudDsKCgogICAgICAgICAgICBpZiAocmVmZXJlbmNlRGF0ZSkgewogICAgICAgICAgICAgIHllc3RlcmRheSA9IHF1ZXJ5RGF0ZXMucGFyc2VEYXRlKHJlZmVyZW5jZURhdGUpOwogICAgICAgICAgICAgIHllc3RlcmRheS5zZXRIb3VycygwKTsKICAgICAgICAgICAgICB5ZXN0ZXJkYXkuc2V0TWludXRlcygwKTsKICAgICAgICAgICAgICB5ZXN0ZXJkYXkuc2V0U2Vjb25kcygwKTsKICAgICAgICAgICAgICB5ZXN0ZXJkYXkuc2V0TWlsbGlzZWNvbmRzKDApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHllc3RlcmRheSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgICAgeWVzdGVyZGF5LnNldEhvdXJzKDApOwogICAgICAgICAgICAgIHllc3RlcmRheS5zZXRNaW51dGVzKDApOwogICAgICAgICAgICAgIHllc3RlcmRheS5zZXRTZWNvbmRzKDApOwogICAgICAgICAgICAgIHllc3RlcmRheS5zZXRNaWxsaXNlY29uZHMoMCk7CiAgICAgICAgICAgICAgeWVzdGVyZGF5LnNldEhvdXJzKC0yNCk7CiAgICAgICAgICAgICAgcmVmZXJlbmNlRGF0ZSA9IHF1ZXJ5RGF0ZXMuZ2V0RGF0ZVN0cmluZyh5ZXN0ZXJkYXkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxdWVyeSA9IG5ldyBQYXJzZS5RdWVyeShSZXBvcnREYWlseUdlbmVyYWwpOwoKICAgICAgICAgICAgcXVlcnkuZXF1YWxUbygncmVmZXJlbmNlX2RhdGUnLCB5ZXN0ZXJkYXkpOwogICAgICAgICAgICBxdWVyeS5maW5kKHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgICAgICAgICBpZiAocmVzdWx0cyAmJiByZXN1bHRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEYXRlIGFscmVhZHkgcmVnaXN0ZXJlZDogJyArIHJlZmVyZW5jZURhdGUpOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFBhc3QoeWVzdGVyZGF5KTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzLnN1Y2Nlc3MoJ3N1Y2Nlc3MnKTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXREYWlseUdlbmVyYWwoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgcmVzLmVycm9yKGUpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIHVuZGVmaW5lZCk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gc2F2ZURhaWx5R2VuZXJhbChfeCwgX3gyKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKClBhcnNlLkNsb3VkLmpvYignc2F2ZURhaWx5R2VuZXJhbCcsIHNhdmVEYWlseUdlbmVyYWwpOwoKbW9kdWxlLmV4cG9ydHMuc2F2ZURhaWx5R2VuZXJhbCA9IHNhdmVEYWlseUdlbmVyYWw7CgpQYXJzZS5DbG91ZC5qb2IoJ3N5bmNVc2VycycsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogIHJlcy5zdWNjZXNzKCk7CiAgcmV0dXJuICgwLCBfZ2V0QjRhVXNlcnMyLmRlZmF1bHQpKCkudGhlbihmdW5jdGlvbiAoYjRhVXNlcnMpIHsKICAgIGNvbnNvbGUubG9nKCdpdHMgYWxpdmUgJyArIGI0YVVzZXJzLmxlbmd0aCk7CiAgICByZXR1cm4gc2F2ZVVzZXJzSW50ZXJ2YWwoYjRhVXNlcnMpOwogIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICBjb25zb2xlLmxvZyhlKTsKICAgIHJlcy5lcnJvcihlKTsKICB9KTsKCiAgZnVuY3Rpb24gc2F2ZVVzZXJzSW50ZXJ2YWwodXNlcnMpIHsKICAgIHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwOwoKICAgIHZhciBwYWNpbmcgPSAxMDAwOwogICAgdmFyIEdvb2dsZUFkd29yZHNEYXRhID0gUGFyc2UuT2JqZWN0LmV4dGVuZCgnR29vZ2xlQWR3b3Jkc0RhdGEnKTsKICAgIGNvbnNvbGUubG9nKCdpbmNsdWRpbmcgdXNlcnM6JyArIGkgKiBwYWNpbmcpOwogICAgdmFyIHNsaWNlZFVzZXJzID0gdXNlcnMuc2xpY2UoaSAqIHBhY2luZywgKGkgKyAxKSAqIHBhY2luZyk7CiAgICBpZiAoc2xpY2VkVXNlcnNbMF0pIHsKICAgICAgcmV0dXJuIF9wcm9taXNlMi5kZWZhdWx0LmFsbChzbGljZWRVc2Vycy5tYXAoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICB2YXIgYjRhVXNlciA9IG5ldyBCNGFVc2VyKCk7CiAgICAgICAgaWYgKCF1c2VyWyd1dG1fc291cmNlJ10gJiYgdXNlclsncmVmZXJlciddICYmICh1c2VyWydyZWZlcmVyJ10uaW5kZXhPZignZmFjZWJvb2suY29tJykgPiAtMSB8fCB1c2VyWydyZWZlcmVyJ10uaW5kZXhPZignaW5zdGFncmFtLmNvbScpID4gLTEpKSB1c2VyWyd1dG1fc291cmNlJ10gPSAnZmFjZWJvb2snOwogICAgICAgIGI0YVVzZXIuc2V0KCdpbnRlcm5hbF9pZCcsIHVzZXJbJ19pZCddKTsKICAgICAgICBiNGFVc2VyLnNldCgnb3JpZ2luYWxfY3JlYXRlZF9hdCcsIHVzZXJbJ2NyZWF0ZWRBdCddKTsKICAgICAgICBiNGFVc2VyLnNldCgnZW1haWwnLCB1c2VyWydlbWFpbCddKTsKICAgICAgICBpZiAodXNlclsncmVmZXJlciddKSBiNGFVc2VyLnNldCgncmVmZXJlcicsIHVzZXJbJ3JlZmVyZXInXSk7CiAgICAgICAgaWYgKHVzZXJbJ2djbGlkJ10pIGI0YVVzZXIuc2V0KCdnY2xpZCcsIHVzZXJbJ2djbGlkJ10pOwogICAgICAgIGlmICh1c2VyWyd1dG1fc291cmNlJ10pIGI0YVVzZXIuc2V0KCd1dG1fc291cmNlJywgdXNlclsndXRtX3NvdXJjZSddKTsKICAgICAgICBpZiAodXNlclsndXRtX2NhbXBhaWduJ10pIGI0YVVzZXIuc2V0KCd1dG1fY2FtcGFpZ24nLCB1c2VyWyd1dG1fY2FtcGFpZ24nXSk7CiAgICAgICAgaWYgKHVzZXJbJ3V0bV90ZXJtJ10pIGI0YVVzZXIuc2V0KCd1dG1fdGVybScsIHVzZXJbJ3V0bV90ZXJtJ10pOwogICAgICAgIGlmICh1c2VyWyd1dG1fY29udGVudCddKSBiNGFVc2VyLnNldCgndXRtX2NvbnRlbnQnLCB1c2VyWyd1dG1fY29udGVudCddKTsKICAgICAgICBpZiAodXNlclsndXRtX21lZGl1bSddKSBiNGFVc2VyLnNldCgndXRtX21lZGl1bScsIHVzZXJbJ3V0bV9tZWRpdW0nXSk7CiAgICAgICAgaWYgKHVzZXJbJ2djbGlkJ10gJiYgIXVzZXJbJ3V0bV9zb3VyY2UnXSkgYjRhVXNlci5zZXQoJ3V0bV9zb3VyY2UnLCAnZ29vZ2xlJyk7CiAgICAgICAgaWYgKHVzZXJbJ3V0bV9zb3VyY2UnXSA9PT0gJ2ZiJykgYjRhVXNlci5zZXQoJ3V0bV9zb3VyY2UnLCAnZmFjZWJvb2snKTsKICAgICAgICBpZiAodXNlclsnZ2NsaWQnXSkgewogICAgICAgICAgdmFyIGFkd29yZHNRdWVyeSA9IG5ldyBQYXJzZS5RdWVyeShHb29nbGVBZHdvcmRzRGF0YSk7CiAgICAgICAgICByZXR1cm4gYWR3b3Jkc1F1ZXJ5LmVxdWFsVG8oJ0djbElkJywgdXNlclsnZ2NsaWQnXSkuc2VsZWN0KFsnQ2FtcGFpZ25OYW1lJywgJ0NhbXBhaWduSWQnXSkuZmlyc3QoKS50aGVuKGZ1bmN0aW9uIChjbGljaykgewogICAgICAgICAgICBpZiAoY2xpY2sgJiYgY2xpY2suZ2V0KCdDYW1wYWlnbk5hbWUnKSkgYjRhVXNlci5zZXQoJ3V0bV9jYW1wYWlnbicsIGNsaWNrLmdldCgnQ2FtcGFpZ25OYW1lJykgKyAnIC0gJyArIGNsaWNrLmdldCgnQ2FtcGFpZ25JZCcpKTsKICAgICAgICAgICAgcmV0dXJuIGI0YVVzZXIuc2F2ZShudWxsLCB7IHVzZU1hc3RlcktleTogdHJ1ZSB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gYjRhVXNlci5zYXZlKG51bGwsIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pOwogICAgICAgIH0KICAgICAgfSkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGkgKz0gMTsKICAgICAgICByZXR1cm4gc2F2ZVVzZXJzSW50ZXJ2YWwodXNlcnMsIGkpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybjsKICAgIH0KICB9Cn0pOwoKdmFyIG1heFBhZ2VzID0gMTA7CnZhciByZXBvcnQgPSBuZXcgX25vZGVBZHdvcmRzLkFkd29yZHNSZXBvcnQoewogIGRldmVsb3BlclRva2VuOiAnc1VTcjJfQmRHZ0FKMEdocnBoVjB5UScsIC8veW91ciBhZHdvcmRzIGRldmVsb3BlclRva2VuCiAgdXNlckFnZW50OiAnQmFjazRBcHAnLCAvL2FueSBjb21wYW55IG5hbWUKICBjbGllbnRDdXN0b21lcklkOiAnMzgyLTcwMi0zNTk3JywgLy90aGUgQWR3b3JkcyBBY2NvdW50IGlkIChlLmcuIDEyMy0xMjMtMTIzKQogIGNsaWVudF9pZDogJzg5ODEzNzg4NzU0Ni12c2F1Zmk5c21vOGZwcHZyYXY2czcxZTBqcXRvOW50cy5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbScsIC8vdGhpcyBpcyB0aGUgYXBpIGNvbnNvbGUgY2xpZW50X2lkCiAgY2xpZW50X3NlY3JldDogJzZ5OEdrYzA4LUNnbExsRXpHTzE2b2pSVycsCiAgcmVmcmVzaF90b2tlbjogJzEvTWZXTGVDQWFIVWk5NlBUcEViaVRMdnVFWnpCVWJGOGpqQXBzek96Yjc2cycKfSk7CnZhciBmaWVsZHMgPSBbJ0FjY291bnREZXNjcmlwdGl2ZU5hbWUnLCAnQWRGb3JtYXQnLCAnQWRHcm91cElkJywgJ0FkR3JvdXBOYW1lJywgJ0FkR3JvdXBTdGF0dXMnLCAnQWROZXR3b3JrVHlwZTEnLCAnQWROZXR3b3JrVHlwZTInLCAnQW9pQ2l0eUNyaXRlcmlhSWQnLCAnQW9pQ291bnRyeUNyaXRlcmlhSWQnLCAnQW9pTWV0cm9Dcml0ZXJpYUlkJywgJ0FvaU1vc3RTcGVjaWZpY1RhcmdldElkJywgJ0FvaVJlZ2lvbkNyaXRlcmlhSWQnLCAnQ2FtcGFpZ25JZCcsICdDYW1wYWlnbkxvY2F0aW9uVGFyZ2V0SWQnLCAnQ2FtcGFpZ25OYW1lJywgJ0NhbXBhaWduU3RhdHVzJywgJ0NsaWNrcycsICdDbGlja1R5cGUnLCAnQ3JlYXRpdmVJZCcsICdDcml0ZXJpYUlkJywgJ0NyaXRlcmlhUGFyYW1ldGVycycsICdEYXRlJywgJ0RldmljZScsICdFeHRlcm5hbEN1c3RvbWVySWQnLCAnR2NsSWQnLCAnS2V5d29yZE1hdGNoVHlwZScsICdMb3BDaXR5Q3JpdGVyaWFJZCcsICdMb3BDb3VudHJ5Q3JpdGVyaWFJZCcsICdMb3BNZXRyb0NyaXRlcmlhSWQnLCAnTG9wTW9zdFNwZWNpZmljVGFyZ2V0SWQnLCAnTG9wUmVnaW9uQ3JpdGVyaWFJZCcsICdNb250aE9mWWVhcicsICdQYWdlJywgJ1Nsb3QnLCAnVXNlckxpc3RJZCddOwp2YXIgZ2V0UmVwb3J0Q29uZmlnID0gZnVuY3Rpb24gZ2V0UmVwb3J0Q29uZmlnKGRhdGUpIHsKICByZXR1cm4gewogICAgcmVwb3J0TmFtZTogJ0NsaWNrIFBlcmZvcm1hbmNlIFJlcG9ydCcsCiAgICByZXBvcnRUeXBlOiAnQ0xJQ0tfUEVSRk9STUFOQ0VfUkVQT1JUJywKICAgIGZpZWxkczogZmllbGRzLAogICAgZGF0ZVJhbmdlVHlwZTogJ0NVU1RPTV9EQVRFJywKICAgIHN0YXJ0RGF0ZTogZGF0ZSwKICAgIGVuZERhdGU6IGRhdGUsCiAgICBmb3JtYXQ6ICdDU1YnIC8vZGVmYXVsdHMgdG8gQ1NWCiAgfTsKfTsKCnZhciByZW1hcFJlc3VsdCA9IGZ1bmN0aW9uIHJlbWFwUmVzdWx0KGpzb25BcnJPYmopIHsKICByZXR1cm4ganNvbkFyck9iai5tYXAoZnVuY3Rpb24gKG9iaikgewogICAgdmFyIG5ld09iaiA9IHt9OwogICAgKDAsIF9rZXlzMi5kZWZhdWx0KShvYmopLmZvckVhY2goZnVuY3Rpb24gKGssIGkpIHsKICAgICAgcmV0dXJuIG5ld09ialtmaWVsZHNbaV1dID0gb2JqW2tdOwogICAgfSk7CiAgICByZXR1cm4gbmV3T2JqOwogIH0pOwp9OwoKUGFyc2UuQ2xvdWQuam9iKCdzeW5jQW5hbHl0aWNzJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgdHJ5IHsKICAgIHZhciBHb29nbGVBZHdvcmRzRGF0YSA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ0dvb2dsZUFkd29yZHNEYXRhJyk7CiAgICB2YXIgc2VhcmNoUGFnZSA9IGZ1bmN0aW9uIHNlYXJjaFBhZ2UoKSB7CiAgICAgIHZhciBwYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwOwoKICAgICAgdmFyIGRhdGUgPSAoMCwgX21vbWVudDIuZGVmYXVsdCkoKS5zdWJ0cmFjdChwYWdlLCAnZGF5cycpLnRvRGF0ZSgpOwogICAgICByZXBvcnQuZ2V0UmVwb3J0KCd2MjAxODAyJywgZ2V0UmVwb3J0Q29uZmlnKGRhdGUpLCBmdW5jdGlvbiAoZXJyb3IsIHJlcG9ydCkgewogICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICByZXMuZXJyb3IoZXJyb3IpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICByZXBvcnQgPSByZXBvcnQuc3Vic3RyaW5nKHJlcG9ydC5pbmRleE9mKCdcbicpICsgMSk7CiAgICAgICAgKDAsIF9jc3Z0b2pzb24yLmRlZmF1bHQpKCkuZnJvbVN0cmluZyhyZXBvcnQpLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgcmVzLmVycm9yKGUpOwogICAgICAgIH0pLm9uKCdlbmRfcGFyc2VkJywgZnVuY3Rpb24gKGpzb25BcnJPYmopIHsKICAgICAgICAgIGpzb25BcnJPYmogPSByZW1hcFJlc3VsdChqc29uQXJyT2JqKTsKICAgICAgICAgIHZhciBnY2xpZHMgPSBqc29uQXJyT2JqLm1hcChmdW5jdGlvbiAobykgewogICAgICAgICAgICByZXR1cm4gby5HY2xJZDsKICAgICAgICAgIH0pOwogICAgICAgICAgLy8gY29uc29sZS5sb2coJ2djbGlkcy5sZW5ndGgnLCBnY2xpZHMubGVuZ3RoKQoKICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdOwogICAgICAgICAgdmFyIHBhZ2VTaXplID0gMTAwMDsKICAgICAgICAgIHZhciBwYWdlcyA9IHBhcnNlSW50KGdjbGlkcy5sZW5ndGggLyBwYWdlU2l6ZSk7CiAgICAgICAgICBjb25zb2xlLmxvZygncGFnZXMnLCBwYWdlcyk7CiAgICAgICAgICBmb3IgKHZhciBfcGFnZSA9IDA7IF9wYWdlIDw9IHBhZ2VzOyBfcGFnZSsrKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdwYWdlJywgcGFnZSkKICAgICAgICAgICAgdmFyIGlkcyA9IGdjbGlkcy5zbGljZShfcGFnZSAqIHBhZ2VTaXplLCAoX3BhZ2UgKyAxKSAqIHBhZ2VTaXplKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2lkcycsIGlkcykKICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KEdvb2dsZUFkd29yZHNEYXRhKTsKICAgICAgICAgICAgcXVlcnkuY29udGFpbmVkSW4oJ0djbElkJywgaWRzKTsKICAgICAgICAgICAgdmFyIHByb21pc2UgPSBxdWVyeS5zZWxlY3QoWydHY2xJZCddKS5saW1pdChpZHMubGVuZ3RoKS5maW5kKHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pOwogICAgICAgICAgICBwcm9taXNlcy5wdXNoKHByb21pc2UpOwogICAgICAgICAgfQogICAgICAgICAgLy8gY29uc29sZS5sb2coJ3Byb21pc2VzLmxlbmd0aCcsIHByb21pc2VzLmxlbmd0aCkKICAgICAgICAgIF9wcm9taXNlMi5kZWZhdWx0LmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAocmVzdWx0cykgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmVzdWx0cycsIHJlc3VsdHMpCiAgICAgICAgICAgIHZhciBzdG9yZWRPYmplY3RzID0gW107CiAgICAgICAgICAgIHJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbiAocikgewogICAgICAgICAgICAgIHJldHVybiBzdG9yZWRPYmplY3RzID0gc3RvcmVkT2JqZWN0cy5jb25jYXQocik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc3RvcmVkT2JqZWN0cy5sZW5ndGgnLCBzdG9yZWRPYmplY3RzLmxlbmd0aCkKICAgICAgICAgICAgdmFyIHN0b3JlZElkcyA9IHN0b3JlZE9iamVjdHMubWFwKGZ1bmN0aW9uIChvKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG8uZ2V0KCdHY2xJZCcpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3N0b3JlZElkcycsIHN0b3JlZElkcykKICAgICAgICAgICAganNvbkFyck9iaiA9IGpzb25BcnJPYmouZmlsdGVyKGZ1bmN0aW9uIChvKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHN0b3JlZElkcy5pbmRleE9mKG8uR2NsSWQpID09PSAtMTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGpzb25BcnJPYmopCiAgICAgICAgICAgIGlmIChqc29uQXJyT2JqLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2aW5nICcgKyBqc29uQXJyT2JqLmxlbmd0aCArICcgb2JqZWN0cycpOwogICAgICAgICAgICAgIHZhciBwYXJzZU9iamVjdHMgPSBqc29uQXJyT2JqLm1hcChmdW5jdGlvbiAobykgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBHb29nbGVBZHdvcmRzRGF0YShvKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBQYXJzZS5PYmplY3Quc2F2ZUFsbChwYXJzZU9iamVjdHMpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdWNjZXNzKCk7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgcmVzLmVycm9yKGUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhbGwgb2JqZWN0cyBhcmUgYWxyZWFkeSBzYXZlZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICByZXMuZXJyb3IoZSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHBhcnNlT2JqZWN0cykKICAgICAgICAgIGlmIChyZXBvcnQgJiYgcGFnZSA8IG1heFBhZ2VzKSBzZWFyY2hQYWdlKCsrcGFnZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfTsKICAgIHNlYXJjaFBhZ2UoMCk7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcihlKTsKICAgIHJlcy5lcnJvcihlKTsKICB9Cn0pOwoKdmFyIHVwZGF0ZUFuYWx5dGljc1VzZXJzRGF0YSA9IF9jbzIuZGVmYXVsdC53cmFwKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgdmFyIGludGVybmFsVXNlcnMsIGludGVybmFsVXNlcnNNYXAsIGdjbGlkcywgYW5hbHl0aWNzRGF0YSwgYW5hbHl0aWNzTWFwLCBjb2hvcnRVc2VzLCB1c2Vyc1RvVXBkYXRlLCB1cGRhdGVSZXN1bHQ7CiAgcmV0dXJuIF9yZWdlbmVyYXRvcjIuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgIHdoaWxlICgxKSB7CiAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGNvbnNvbGUubG9nKCdzdGFydGluZyB1cGRhdGVBbmFseXRpY3NVc2Vyc0RhdGEnKTsKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgIHJldHVybiBfZ2V0QjRhVXNlcnMyLmRlZmF1bHQuZ2V0QWxsSW50ZXJuYWxVc2VycygpOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBpbnRlcm5hbFVzZXJzID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgY29uc29sZS5sb2coJ2ludGVybmFsVXNlcnMubGVuZ3RoJywgaW50ZXJuYWxVc2Vycy5sZW5ndGgpOwogICAgICAgICAgaW50ZXJuYWxVc2Vyc01hcCA9IGludGVybmFsVXNlcnMucmVkdWNlKGZ1bmN0aW9uIChtYXAsIHVzZXIpIHsKICAgICAgICAgICAgbWFwW3VzZXIuX2lkXSA9IHVzZXI7CiAgICAgICAgICAgIHJldHVybiBtYXA7CiAgICAgICAgICB9LCB7fSk7CiAgICAgICAgICBnY2xpZHMgPSBpbnRlcm5hbFVzZXJzLm1hcChmdW5jdGlvbiAodSkgewogICAgICAgICAgICByZXR1cm4gdS5nY2xpZDsKICAgICAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoZ2NsaWQpIHsKICAgICAgICAgICAgcmV0dXJuIGdjbGlkOwogICAgICAgICAgfSk7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDk7CiAgICAgICAgICByZXR1cm4gX2dldEI0YVVzZXJzMi5kZWZhdWx0LmdldEFsbEdvb2dsZUFuYWx5dGNzRGF0YShnY2xpZHMpOwoKICAgICAgICBjYXNlIDk6CiAgICAgICAgICBhbmFseXRpY3NEYXRhID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgY29uc29sZS5sb2coJ2FuYWx5dGljc0RhdGEubGVuZ3RoJywgYW5hbHl0aWNzRGF0YS5sZW5ndGgpOwogICAgICAgICAgYW5hbHl0aWNzTWFwID0gYW5hbHl0aWNzRGF0YS5yZWR1Y2UoZnVuY3Rpb24gKG1hcCwgYSkgewogICAgICAgICAgICBpZiAoYSAmJiBhLkdjbElkKSBtYXBbYS5HY2xJZF0gPSBhOwogICAgICAgICAgICByZXR1cm4gbWFwOwogICAgICAgICAgfSwge30pOwogICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgIHJldHVybiBfZ2V0QjRhVXNlcnMyLmRlZmF1bHQuZ2V0QWxsQ29ob3J0VXNlcnMoKTsKCiAgICAgICAgY2FzZSAxNDoKICAgICAgICAgIGNvaG9ydFVzZXMgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICBjb25zb2xlLmxvZygnY29ob3J0VXNlcy5sZW5ndGgnLCBjb2hvcnRVc2VzLmxlbmd0aCk7CiAgICAgICAgICB1c2Vyc1RvVXBkYXRlID0gY29ob3J0VXNlcy5maWx0ZXIoZnVuY3Rpb24gKHUpIHsKICAgICAgICAgICAgdmFyIGludGVybmFsVXNlciA9IGludGVybmFsVXNlcnNNYXBbdS5pbnRlcm5hbF9pZF07CiAgICAgICAgICAgIGlmICghaW50ZXJuYWxVc2VyKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIHZhciB1cGRhdGUgPSBmYWxzZTsKICAgICAgICAgICAgdmFyIGNsaWNrID0gKHUuZ2NsaWQgfHwgaW50ZXJuYWxVc2VyICYmIGludGVybmFsVXNlci5nY2xpZCkgJiYgYW5hbHl0aWNzTWFwW3UuZ2NsaWQgfHwgaW50ZXJuYWxVc2VyLmdjbGlkXTsKICAgICAgICAgICAgaWYgKGNsaWNrICYmICF1LnV0bV9zb3VyY2UpIHsKICAgICAgICAgICAgICB1LnV0bV9zb3VyY2UgPSAnZ29vZ2xlJzsKICAgICAgICAgICAgICB1cGRhdGUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjbGljayAmJiAhdS51dG1fY2FtcGFpZ24pIHsKICAgICAgICAgICAgICB1LnV0bV9jYW1wYWlnbiA9IGNsaWNrLkNhbXBhaWduTmFtZSArICcgLSAnICsgY2xpY2suQ2FtcGFpZ25JZDsKICAgICAgICAgICAgICB1cGRhdGUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdS51dG1fc291cmNlICYmIGludGVybmFsVXNlci51dG1fc291cmNlKSB7CiAgICAgICAgICAgICAgdS51dG1fc291cmNlID0gaW50ZXJuYWxVc2VyLnV0bV9zb3VyY2U7CiAgICAgICAgICAgICAgdXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXUudXRtX2NhbXBhaWduICYmIGludGVybmFsVXNlci51dG1fY2FtcGFpZ24pIHsKICAgICAgICAgICAgICB1LnV0bV9jYW1wYWlnbiA9IGludGVybmFsVXNlci51dG1fY2FtcGFpZ247CiAgICAgICAgICAgICAgdXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXUudXRtX3Rlcm0gJiYgaW50ZXJuYWxVc2VyLnV0bV90ZXJtKSB7CiAgICAgICAgICAgICAgdS51dG1fdGVybSA9IGludGVybmFsVXNlci51dG1fdGVybTsKICAgICAgICAgICAgICB1cGRhdGUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghdS51dG1fbWVkaXVtICYmIGludGVybmFsVXNlci51dG1fbWVkaXVtKSB7CiAgICAgICAgICAgICAgdS51dG1fbWVkaXVtID0gaW50ZXJuYWxVc2VyLnV0bV9tZWRpdW07CiAgICAgICAgICAgICAgdXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXUudXRtX2NvbnRlbnQgJiYgaW50ZXJuYWxVc2VyLnV0bV9jb250ZW50KSB7CiAgICAgICAgICAgICAgdS51dG1fY29udGVudCA9IGludGVybmFsVXNlci51dG1fY29udGVudDsKICAgICAgICAgICAgICB1cGRhdGUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh1LnV0bV9zb3VyY2UgPT09ICdmYicpIHsKICAgICAgICAgICAgICB1LnV0bV9zb3VyY2UgPSAnZmFjZWJvb2snOwogICAgICAgICAgICAgIHVwZGF0ZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHVwZGF0ZSkgdS5zeW5jZWRBdCA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIHJldHVybiB1cGRhdGU7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBjb25zb2xlLmxvZygndXNlcnNUb1VwZGF0ZS5sZW5ndGgnLCB1c2Vyc1RvVXBkYXRlLmxlbmd0aCk7CiAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIwOwogICAgICAgICAgcmV0dXJuIF9nZXRCNGFVc2VyczIuZGVmYXVsdC51cGRhdGVDb2hvcnRVc2Vycyh1c2Vyc1RvVXBkYXRlKTsKCiAgICAgICAgY2FzZSAyMDoKICAgICAgICAgIHVwZGF0ZVJlc3VsdCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGRhdGVSZXN1bHQnLCB1cGRhdGVSZXN1bHQpOwogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoJ3JldHVybicsICdzdWNjZXNzJyk7CgogICAgICAgIGNhc2UgMjM6CiAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgX2NhbGxlZTIsIHRoaXMpOwp9KSk7CgpQYXJzZS5DbG91ZC5qb2IoJ3VwZGF0ZUFuYWx5dGljc1VzZXJzRGF0YScsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogIHVwZGF0ZUFuYWx5dGljc1VzZXJzRGF0YSgpLnRoZW4ocmVzLnN1Y2Nlc3MpLmNhdGNoKHJlcy5lcnJvcik7Cn0pOwoKbW9kdWxlLmV4cG9ydHMudXBkYXRlQW5hbHl0aWNzVXNlcnNEYXRhID0gdXBkYXRlQW5hbHl0aWNzVXNlcnNEYXRhOw=="}},{"text":"lib","children":[{"text":"back4app.json","data":{"code":"data:plain/text;base64,ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiYmFjazRhcHAtMTczMzE4IiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiYmJhZmZlYTMyNTI2MjUxNzFmMTk2NWIyMmZmNzczNmU5NGYwYzY0OSIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZRSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2N3Z2dTakFnRUFBb0lCQVFDNWZqalVYOERoaDhxUlxuVHFpbi94MzlJeGhpdXQ5bG4rTGFiWERuWkxkcnZZZ0FaOFF4dW1aTW5keVZ2V2xhMVBDRU94aS9HY3g0TzUxb1xuRHA4MFpZdmM0dVU5RmpOZ01wVi8rTjlRckpyTUpCYnh4V0xPRkphcUJwUXhFZTFMaFRqVGREeU5obWtpcE1TNFxuN3V0L1E3ckprTk5telIwc1R3WlY0TWtobFlFc2hSSmZXVVVDeEFJaVJMSzhTMlM2a21hdHY2TGgvVTBuMVBXalxuNWFBbVBuSDZQcWcwVFFyY1pTK1hHdzZmTEQ1QzJpSFpFTFBENEViMVR3c0o4RjlBMFN6WmxKMC9Od2I1akltb1xuNnN4WGdUVHlnc01JOVZKMkovNkp6UnFWdEtCVnJGNmJsejhsNzVyWlJZWXZKNFI4bFpzM3hIczI3ZmhjR1JUZ1xuKzFucWkxUkpBZ01CQUFFQ2dnRUFFRFYvbVhpaWsxMU9nMk1URkN4cGFQT0xwU09ubmlydlk3U1kzMGVBU3dtOVxuWEMwS2RSUDdtTlN2UldYUFVvWWdCd0N6cnJpbzZFQVdzYW54YnpQZWJ4ZGovbklMQnV3ZlZKYjJvTEhzakV2WFxudGhuUVYvOXU2UDJqMlNQZXVnWXl0ZHVjUFB1OVY5blJGNTN5ZGVVQkZLMnpUaHpuWUl0VDhPWXdmVFJNeDRzcVxuaytNekRydDBmZmgxNUs1QXd1Z0tSd1dVN0JzVlRuV0JQeDByRDgxOHFGdVViajU0YytlaWFYTHBReVc4RkxBRlxuOTBSTGFVUnFEUmlkS2o1QUgrZDJPSWNIVzBnRE5FSERuZ2VHN1JyaHptNi9XZld5OG1lNzl3TlgydzZGYmI0R1xualFNOXB4WktqbGlkNG0rYitXYkY4ckEwUUtzMk9FaE8zL0Jmd2E4VjV3S0JnUURjRklLeUxZNXZlNTlmQzRRQlxuU1ZTam1NeEZYbDFDWWIrYTVhanROSmNQU2Y3a0U1VXFLeXRjMDBWTlNvMXU5ckdGK3hFMCt5ZXE4aXkrRmJ5TFxuRTBkckR2Yy9nNVVNVXBVbEJOc05mNmg0TTJER3g0RnhveVR4U3RNUXZ3SlhFSmZ3Z1c2UU5WNURYY2pHODlhU1xuNE9HRmNWalRFbGxlYmE1NmovWDhHajl2VXdLQmdRRFh4SlFtS216aG9LYUNtVXZoUGJsTGVNcUNvMXNVR1lOUFxuMHJiZ1RYL0NVOXJMUzZFR3VXY0VnY2Z3dWc1eFFYaGhRQVpreTIwS3FBSms1OVRPV2k4V3NDMWtxYXNmRE1EL1xuSWRpVjNFMlR0Q1lLWVRCTzRDT0Mxb29Za29nWWhLWGF1OEFnTlB5RjNLR3V5VmxmeEpvZXVZQ2FMZU16Rm1pTlxuN0V2dFVhSW1jd0tCZ0FsdTA1OUJkcDV1cFFrVTNFYVYxd3ZnQzdsWmJ4UGVUckViOE42aDUydWZWMDU5VEdKdlxuVVQ5OFNyY2lYK2VHcVZzOXhLSUp0Y3lNN3NBQy9IN1ZoN1VlQWhqMTBkaWlYWVFscmlIbys5YVRGUzNQOVV0aVxubTcyLzRFWVNlYzR6aHQrbkhJOFB5b2VHcUlsbWdDYnhmcGtTbjZVRVgxSTl6MEd2ay9LSFNYckRBb0dCQUtVN1xuSWFSMGVycng5bkV1aVlBc2IxaFBZTzFYd1dpTC9SWEVyRXpxckRxWlVvUzZIczd5YmVSeXFqVTdsZEcvTER0MFxuOXpCNjQ3NzBXQmtEdStCbUNZZGJWUGV3UXAzZGUzSWxiaUdjK2o5eEJteU9icHNJWThsUEY2T25tdGNEeGFyU1xuZWxkdm5DMjZmb3BHSU00STFXbFA3eDZpbzBrOUVNWVdQVEs0Zis3bkFvR0FkNXpoeElHZkx4Q2ZqRXBJTDJMR1xuZlJKc2V2bHVHT2crVWV6aHlUUkNack9la3dnOU1OaThyVFVuVjVyNThzVjlZdFdTQnNyMnNrZlhTelhJQVZPTlxuU0V6cXhpTVZRU29BWHRJK0dpMWw1WG0waXVOVC9wMXpzSE1YM0xZYTBMVmh0NGJJZUc2b1lUcWJDV1dsS1JSWVxuUUtGeWlLYWNVWmM2NzdjOURVRWFpQWc9XG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAiY29ob3J0LXJlcG9ydEBiYWNrNGFwcC0xNzMzMTguaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTEyMDQ3NzI4NjQxMTAxNDQ1MTQ2IiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL3Rva2VuIiwKICAiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsCiAgImNsaWVudF94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3JvYm90L3YxL21ldGFkYXRhL3g1MDkvY29ob3J0LXJlcG9ydCU0MGJhY2s0YXBwLTE3MzMxOC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIKfQo="}},{"text":"getAPICalls.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9wcm9taXNlID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UnKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgUmVhZFByZWZlcmVuY2UgPSByZXF1aXJlKCdtb25nb2RiJykuUmVhZFByZWZlcmVuY2U7CnZhciBxdWVyeURhdGVzID0gcmVxdWlyZSgnLi4vdXRpbC9xdWVyeURhdGVzJyk7CnZhciBkYiA9IHJlcXVpcmUoJy4uL3V0aWwvZGInKTsKdmFyIHNldHRpbmdzID0gcmVxdWlyZSgnLi4vc2V0dGluZ3MnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGlkLCBfcXVlcnkpIHsKICB2YXIgcXVlcnk7CiAgdmFyIGNvdW50ID0gMDsKICB2YXIgdXNlcnMgPSB7fTsKICB2YXIgZGF0YSA9IHt9OwogIHZhciBjb25uRGI7CiAgdHJ5IHsKICAgIHF1ZXJ5ID0gSlNPTi5wYXJzZShfcXVlcnkpOwogIH0gY2F0Y2ggKGUpIHsKICAgIHF1ZXJ5ID0gX3F1ZXJ5OwogIH0KCiAgdmFyIHJlc3BvbnNlID0ge307CgogIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLk1PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiKSB7CiAgICBjb25uRGIgPSBfZGI7CiAgICByZXR1cm4gX2RiLmNvbGxlY3Rpb24oJ1BhcnNlQXBwJywgeyByZWFkUHJlZmVyZW5jZTogUmVhZFByZWZlcmVuY2UuU0VDT05EQVJZX1BSRUZFUlJFRCB9KS5maW5kKHt9LCB7IGFwcElkOiAxLCBvd25lcjogMSB9KS5zb3J0KHsgJG5hdHVyYWw6IC0xIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uIChhcHBzKSB7CiAgICAgIHJldHVybiBnZXRSZWN1cnNpdmVseShhcHBzKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXNwb25zZS5hcGlDYWxscyA9IGNvdW50OwogICAgICBpZiAocXVlcnkucGVyVXNlcnMgPT09IHRydWUpIHsKICAgICAgICByZXNwb25zZS5wZXJVc2VycyA9IHVzZXJzOwogICAgICB9CiAgICAgIHJldHVybiBfZGIuY2xvc2UoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gW3Jlc3BvbnNlXTsKICAgICAgfSk7CiAgICB9KTsKICB9KTsKCiAgZnVuY3Rpb24gZ2V0UmVjdXJzaXZlbHkoYXBwcywgaSkgewogICAgaSA9IGkgPyBpIDogMDsKICAgIHZhciBwYWNpbmcgPSA1MDA7CiAgICB2YXIgc2xpY2VkQXBwcyA9IGFwcHMuc2xpY2UoaSAqIHBhY2luZywgKGkgKyAxKSAqIHBhY2luZyk7CiAgICBpZiAoIXNsaWNlZEFwcHNbMF0pIHJldHVybjsKICAgIHJldHVybiBfcHJvbWlzZTIuZGVmYXVsdC5hbGwoc2xpY2VkQXBwcy5tYXAoZnVuY3Rpb24gKGFwcCkgewogICAgICByZXR1cm4gY29ubkRiLmNvbGxlY3Rpb24oJ1JlcXVlc3RDb3VudGVyJykuYWdncmVnYXRlKFt7ICRtYXRjaDogeyBfaWQ6IHsgJyRndGUnOiBhcHAuYXBwSWQgKyAnOicgKyBxdWVyeS5iZWdpbkRhdGUsICckbHQnOiBhcHAuYXBwSWQgKyAnOicgKyBxdWVyeS5lbmREYXRlIH0gfSB9LCB7ICRncm91cDogeyBfaWQ6IGFwcC5hcHBJZCwgdG90YWw6IHsgJHN1bTogJyR0b3RhbCcgfSB9IH1dLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgICAgaWYgKHJlc3VsdHMgJiYgcmVzdWx0c1swXSAmJiByZXN1bHRzWzBdLnRvdGFsKSB7CiAgICAgICAgICB1c2Vyc1thcHAub3duZXIuaWRdID0gdXNlcnNbYXBwLm93bmVyLmlkXSA/IHVzZXJzW2FwcC5vd25lci5pZF0gKyByZXN1bHRzWzBdLnRvdGFsIDogcmVzdWx0c1swXS50b3RhbDsKICAgICAgICAgIGNvdW50ICs9IHJlc3VsdHNbMF0udG90YWw7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgaSArPSAxOwogICAgICByZXR1cm4gZ2V0UmVjdXJzaXZlbHkoYXBwcywgaSk7CiAgICB9KTsKICB9Cn07Cgptb2R1bGUuZXhwb3J0cy5xdWVyeVRlbXBsYXRlID0gewogIGJlZ2luRGF0ZTogJzIwMTcwNTIzJywKICBlbmREYXRlOiAnMjAxNzA1MzAnLAogIHBlclVzZXJzOiBmYWxzZQp9Ow=="}},{"text":"getActivationDate.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKLy92YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7Cgp2YXIgX3JlZ2VuZXJhdG9yID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9yZWdlbmVyYXRvcicpOwoKdmFyIF9yZWdlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWdlbmVyYXRvcik7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3InKTsKCnZhciBfYXN5bmNUb0dlbmVyYXRvcjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3luY1RvR2VuZXJhdG9yMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIFJlYWRQcmVmZXJlbmNlID0gcmVxdWlyZSgnbW9uZ29kYicpLlJlYWRQcmVmZXJlbmNlOwp2YXIgcXVlcnlEYXRlcyA9IHJlcXVpcmUoJy4uL3V0aWwvcXVlcnlEYXRlcycpOwp2YXIgZGIgPSByZXF1aXJlKCcuLi91dGlsL2RiJyk7CnZhciBzZXR0aW5ncyA9IHJlcXVpcmUoJy4uL3NldHRpbmdzJyk7Cgp2YXIgdXBkYXRlVXNlcnMgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IzLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfZGIsIHVzZXJzKSB7CiAgICB2YXIgYmF0Y2g7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGJhdGNoID0gX2RiLmNvbGxlY3Rpb24oJ0I0YVVzZXInKS5pbml0aWFsaXplVW5vcmRlcmVkQnVsa09wKHsgdXNlTGVnYWN5T3BzOiB0cnVlIH0pOwoKCiAgICAgICAgICAgIHVzZXJzLmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgICAgICBiYXRjaC5maW5kKHsgX2lkOiB1c2VyLl9pZC5zcGxpdCgnJCcpLnBvcCgpLCBhY3RpdmF0aW9uX2RhdGU6IG51bGwgfSkudXBkYXRlT25lKHsgJHNldDogeyBhY3RpdmF0aW9uX2RhdGU6IHVzZXIuYWN0aXZhdGlvbl9kYXRlIH0gfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIGJhdGNoLmV4ZWN1dGUoKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICdlbmQnOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSwgdW5kZWZpbmVkKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiB1cGRhdGVVc2VycyhfeCwgX3gyKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCnZhciBnZXRBY3RpdmVVc2VycyA9IGZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjIgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IzLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoX2RiKSB7CiAgICB2YXIgQWN0aXZlVXNlcnM7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBfZGIuY29sbGVjdGlvbignYWN0aXZlX3VzZXJzJywgeyByZWFkUHJlZmVyZW5jZTogUmVhZFByZWZlcmVuY2UuU0VDT05EQVJZX1BSRUZFUlJFRCB9KS5maW5kKCkudG9BcnJheSgpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgQWN0aXZlVXNlcnMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoJ3JldHVybicsIEFjdGl2ZVVzZXJzKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICdlbmQnOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyLCB1bmRlZmluZWQpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIGdldEFjdGl2ZVVzZXJzKF94MykgewogICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIGdldERCID0gZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjMuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgIHJldHVybiBfcmVnZW5lcmF0b3IyLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgncmV0dXJuJywgX2NvbnRleHQzLnNlbnQpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgIGNhc2UgJ2VuZCc6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMsIHVuZGVmaW5lZCk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZ2V0REIoKSB7CiAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgZXhlYyA9IGZ1bmN0aW9uICgpIHsKICB2YXIgX3JlZjQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IzLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICB2YXIgX2RiLCB1c2VyczsKCiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBnZXREQigpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgX2RiID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIGdldEFjdGl2ZVVzZXJzKF9kYik7CgogICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICB1c2VycyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgIHJldHVybiB1cGRhdGVVc2VycyhfZGIsIHVzZXJzKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCdyZXR1cm4nLCAnU1VDQ0VTUycpOwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgIGNhc2UgJ2VuZCc6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTQsIHVuZGVmaW5lZCk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZXhlYygpIHsKICAgIHJldHVybiBfcmVmNC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkgewogIGV4ZWMoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICBwcm9jZXNzLmV4aXQoMCk7CiAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgY29uc29sZS5lcnJvcihlcnIpOwogICAgcHJvY2Vzcy5leGl0KGVycik7CiAgfSk7Cn0KCm1vZHVsZS5leHBvcnRzID0gZXhlYzs="}},{"text":"getActiveApps.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKLy92YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7Cgp2YXIgX3RydW5jID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL21hdGgvdHJ1bmMnKTsKCnZhciBfdHJ1bmMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJ1bmMpOwoKdmFyIF9wcm9taXNlID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UnKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCnZhciBfa2V5cyA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3Qva2V5cycpOwoKdmFyIF9rZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2tleXMpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBSZWFkUHJlZmVyZW5jZSA9IHJlcXVpcmUoJ21vbmdvZGInKS5SZWFkUHJlZmVyZW5jZTsKdmFyIHF1ZXJ5RGF0ZXMgPSByZXF1aXJlKCcuLi91dGlsL3F1ZXJ5RGF0ZXMnKTsKdmFyIGRiID0gcmVxdWlyZSgnLi4vdXRpbC9kYicpOwp2YXIgc2V0dGluZ3MgPSByZXF1aXJlKCcuLi9zZXR0aW5ncycpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaWQsIF9xdWVyeSkgewogIHZhciBxdWVyeTsKICB2YXIgY291bnQgPSAwOwogIHZhciB1c2VycyA9IHt9OwogIHZhciBkYXRhID0ge307CiAgdmFyIGNvbm5EYjsKICB0cnkgewogICAgcXVlcnkgPSBKU09OLnBhcnNlKF9xdWVyeSk7CiAgfSBjYXRjaCAoZSkgewogICAgcXVlcnkgPSBfcXVlcnk7CiAgfQoKICB2YXIgcmVzcG9uc2UgPSB7fTsKCiAgaWYgKCFxdWVyeS5lbmREYXRlIHx8ICFxdWVyeS5iZWdpbkRhdGUpIHsKICAgIHZhciBlbmREYXRlID0gbmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpKSk7CiAgICB2YXIgYmVnaW5EYXRlID0gbmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpIC0gNykpOwoKICAgIHF1ZXJ5LmJlZ2luRGF0ZSA9ICcnICsgYmVnaW5EYXRlLmdldEZ1bGxZZWFyKCkgKyBmb3JtYXREYXRlKGJlZ2luRGF0ZS5nZXRNb250aCgpICsgMSkgKyBmb3JtYXREYXRlKGJlZ2luRGF0ZS5nZXREYXRlKCkpOwogICAgcXVlcnkuZW5kRGF0ZSA9ICcnICsgZW5kRGF0ZS5nZXRGdWxsWWVhcigpICsgZm9ybWF0RGF0ZShlbmREYXRlLmdldE1vbnRoKCkgKyAxKSArIGZvcm1hdERhdGUoZW5kRGF0ZS5nZXREYXRlKCkpOwogIH0KCiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuTU9OR09fVVJJKS50aGVuKGZ1bmN0aW9uIChfZGIpIHsKICAgIGNvbm5EYiA9IF9kYjsKICAgIHJldHVybiBfZGIuY29sbGVjdGlvbignUGFyc2VBcHAnLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLmZpbmQoe30sIHsgYXBwSWQ6IDEsIG93bmVyOiAxIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uIChhcHBzKSB7CiAgICAgIHJldHVybiBnZXRSZWN1cnNpdmVseShhcHBzKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXNwb25zZS5hY3RpdmVBcHBzID0gY291bnQ7CiAgICAgIHJlc3BvbnNlLmFjdGl2ZVVzZXJzID0gKDAsIF9rZXlzMi5kZWZhdWx0KSh1c2VycykubGVuZ3RoOwogICAgICBpZiAocXVlcnkucGVyVXNlcnMgPT09IHRydWUpIHsKICAgICAgICByZXNwb25zZS5wZXJVc2VycyA9IHVzZXJzOwogICAgICB9CiAgICAgIHJldHVybiBfZGIuY2xvc2UoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gW3Jlc3BvbnNlXTsKICAgICAgfSk7CiAgICB9KTsKICB9KTsKCiAgZnVuY3Rpb24gZ2V0UmVjdXJzaXZlbHkoYXBwcywgaSkgewogICAgaSA9IGkgPyBpIDogMDsKICAgIHZhciBwYWNpbmcgPSA1MDA7CiAgICB2YXIgc2xpY2VkQXBwcyA9IGFwcHMuc2xpY2UoaSAqIHBhY2luZywgKGkgKyAxKSAqIHBhY2luZyk7CiAgICBpZiAoIXNsaWNlZEFwcHNbMF0pIHJldHVybjsKICAgIHJldHVybiBfcHJvbWlzZTIuZGVmYXVsdC5hbGwoc2xpY2VkQXBwcy5tYXAoZnVuY3Rpb24gKGFwcCkgewogICAgICByZXR1cm4gY29ubkRiLmNvbGxlY3Rpb24oJ1JlcXVlc3RDb3VudGVyJykuY291bnQoewogICAgICAgIF9pZDogeyAnJGd0ZSc6IGFwcC5hcHBJZCArICc6JyArIHF1ZXJ5LmJlZ2luRGF0ZSwgJyRsdCc6IGFwcC5hcHBJZCArICc6JyArIHF1ZXJ5LmVuZERhdGUgfQogICAgICB9LCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgICB2YXIgbGVuZ3RoID0gKDAsIF90cnVuYzIuZGVmYXVsdCkoKHF1ZXJ5RGF0ZXMucGFyc2VEYXRlKHF1ZXJ5LmVuZERhdGUpIC0gcXVlcnlEYXRlcy5wYXJzZURhdGUocXVlcnkuYmVnaW5EYXRlKSkgLyA4NjQwMDAwMCk7CiAgICAgICAgaWYgKHJlc3VsdHMgPj0gbGVuZ3RoICYmIGFwcC5vd25lciAmJiBhcHAub3duZXIuaWQpIHsKICAgICAgICAgIHVzZXJzW2FwcC5vd25lci5pZF0gPSB1c2Vyc1thcHAub3duZXIuaWRdID8gdXNlcnNbYXBwLm93bmVyLmlkXSArIDEgOiAxOwogICAgICAgICAgY291bnQrKzsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKGNvbnNvbGUuZXJyb3IpOwogICAgfSkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICBpICs9IDE7CiAgICAgIHJldHVybiBnZXRSZWN1cnNpdmVseShhcHBzLCBpKTsKICAgIH0pOwogIH0KfTsKCmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkgewogIGlmIChkYXRlIDwgMTApIHsKICAgIHJldHVybiAnJyArIDAgKyBkYXRlOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZGF0ZTsKICB9Cn0KCm1vZHVsZS5leHBvcnRzLnF1ZXJ5VGVtcGxhdGUgPSB7CiAgYmVnaW5EYXRlOiAnMjAxNzA1MjMnLAogIGVuZERhdGU6ICcyMDE3MDUzMCcsCiAgcGVyVXNlcnM6IGZhbHNlCn07"}},{"text":"getAnalyticsData.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9wcm9taXNlID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UnKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgZ29vZ2xlID0gcmVxdWlyZSgnZ29vZ2xlYXBpcycpOwp2YXIga2V5ID0gcmVxdWlyZSgnLi9iYWNrNGFwcC5qc29uJyk7CnZhciBqd3RDbGllbnQgPSBuZXcgZ29vZ2xlLmF1dGguSldUKGtleS5jbGllbnRfZW1haWwsIG51bGwsIGtleS5wcml2YXRlX2tleSwgWydodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2FuYWx5dGljcy5yZWFkb25seScsICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2FuYWx5dGljcyddLCBudWxsKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGRhdGUpIHsKICB2YXIgcmVmZXJlbmNlRGF0ZSA9IGRhdGUgPyBmb3JtYXREYXRlKGRhdGUpIDogJ3llc3RlcmRheSc7CiAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBqd3RDbGllbnQuYXV0aG9yaXplKGZ1bmN0aW9uIChlcnIsIHRva2VucykgewogICAgICBpZiAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7CiAgICAgIH0KCiAgICAgIHZhciBhbmFseXRpY3NSZXBvcnRpbmcgPSBnb29nbGUuYW5hbHl0aWNzcmVwb3J0aW5nKHsKICAgICAgICB2ZXJzaW9uOiAndjQnLAogICAgICAgIGF1dGg6IGp3dENsaWVudAogICAgICB9KTsKCiAgICAgIGFuYWx5dGljc1JlcG9ydGluZy5yZXBvcnRzLmJhdGNoR2V0KHsKICAgICAgICByZXNvdXJjZTogewogICAgICAgICAgJ3JlcG9ydFJlcXVlc3RzJzogW3sKICAgICAgICAgICAgJ3ZpZXdJZCc6ICcxMDY0NDM5NDInLAogICAgICAgICAgICAnZGF0ZVJhbmdlcyc6IFt7CiAgICAgICAgICAgICAgJ3N0YXJ0RGF0ZSc6IHJlZmVyZW5jZURhdGUsCiAgICAgICAgICAgICAgJ2VuZERhdGUnOiByZWZlcmVuY2VEYXRlCiAgICAgICAgICAgIH1dLAogICAgICAgICAgICAnbWV0cmljcyc6IFt7CiAgICAgICAgICAgICAgJ2V4cHJlc3Npb24nOiAnZ2E6c2Vzc2lvbnMnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAnZXhwcmVzc2lvbic6ICdnYTpuZXdVc2VycycKICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICdkaW1lbnNpb25zJzogW3sKICAgICAgICAgICAgICAnbmFtZSc6ICdnYTpudGhEYXknLAogICAgICAgICAgICAgICdoaXN0b2dyYW1CdWNrZXRzJzogWycwJ10KICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICdvcmRlckJ5cyc6IFt7CiAgICAgICAgICAgICAgJ2ZpZWxkTmFtZSc6ICdnYTpudGhEYXknLAogICAgICAgICAgICAgICdvcmRlclR5cGUnOiAnSElTVE9HUkFNX0JVQ0tFVCcsCiAgICAgICAgICAgICAgJ3NvcnRPcmRlcic6ICdBU0NFTkRJTkcnCiAgICAgICAgICAgIH1dCiAgICAgICAgICB9XQogICAgICAgIH0KICAgICAgfSwgeyB1c2VRdWVyeXN0cmluZzogZmFsc2UgfSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQucmVwb3J0cyAmJiByZXN1bHQucmVwb3J0c1swXSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQucmVwb3J0c1swXS5kYXRhLnJvd3NbMF0ubWV0cmljc1swXS52YWx1ZXMpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoJ1dyb25nIHJlcG9ydCBmb3JtYXQnKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVqZWN0KCdXcm9uZyByZXBvcnRzJyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogIH0pOwp9OwoKZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlKSB7CiAgZGF0ZSA9IGRhdGUuc3Vic3RyKDAsIDQpICsgJy0nICsgZGF0ZS5zdWJzdHIoNCwgMikgKyAnLScgKyBkYXRlLnN1YnN0cig2LCAyKTsKICByZXR1cm4gZGF0ZTsKfQ=="}},{"text":"getAppsPerUser.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIFJlYWRQcmVmZXJlbmNlID0gcmVxdWlyZSgnbW9uZ29kYicpLlJlYWRQcmVmZXJlbmNlOwp2YXIgZGIgPSByZXF1aXJlKCcuLi91dGlsL2RiJyk7CnZhciBzZXR0aW5ncyA9IHJlcXVpcmUoJy4uL3NldHRpbmdzJyk7Cgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh1c2VycywgZGF0ZSkgewogIHZhciByZXN1bHQgPSB7fTsKICByZXR1cm4gZGIuZ2V0Q29ubmVjdGlvbihzZXR0aW5ncy5NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYikgewogICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdQYXJzZUFwcCcsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgICdvd25lci5pZCc6IHsgJGluOiB1c2VycyB9LAogICAgICAnY3JlYXRlZEF0JzogeyAkbHQ6IGRhdGUgfQogICAgfSwgeyBhcHBJZDogMSwgb3duZXI6IDEgfSkudG9BcnJheSgpLnRoZW4oZnVuY3Rpb24gKGFwcHMpIHsKICAgICAgY29uc29sZS5sb2coJ2dldEFwcHNQZXJVc2VyIFBhcnNlQXBwJyk7CiAgICAgIHZhciBhcHBJZHMgPSBhcHBzLm1hcChmdW5jdGlvbiAoYXBwKSB7CiAgICAgICAgcmV0dXJuIGFwcC5hcHBJZDsKICAgICAgfSk7CiAgICAgIHJldHVybiBfZGIuY29sbGVjdGlvbignUGxhbicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgICAgYXBwSWQ6IHsgJGluOiBhcHBJZHMgfSwKICAgICAgICBjb3Vwb25JZDogbnVsbCwKICAgICAgICBwbGFuTmFtZTogeyAkZXhpc3RzOiB0cnVlLCAkbmU6ICdGcmVlIFBsYW4nIH0sCiAgICAgICAgYXBwVHlwZTogJ3BhcnNlJywKICAgICAgICBjcmVhdGVkQXQ6IHsgJGx0OiBkYXRlIH0KICAgICAgfSkudG9BcnJheSgpLnRoZW4oZnVuY3Rpb24gKHBsYW5zKSB7CiAgICAgICAgY29uc29sZS5sb2coJ2dldEFwcHNQZXJVc2VyIFBsYW4nKTsKCiAgICAgICAgcmV0dXJuIHBsYW5zLm1hcChmdW5jdGlvbiAocGxhbikgewogICAgICAgICAgcmV0dXJuIHBsYW4uYXBwSWQ7CiAgICAgICAgfSk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHBsYW5zKSB7CiAgICAgICAgcmVzdWx0LnBlclVzZXIgPSB7fTsKICAgICAgICBjb25zb2xlLmxvZygnZ2V0QXBwc1BlclVzZXIgQWZ0ZXIgUGxhbicpOwogICAgICAgIHJldHVybiBhcHBzLmZvckVhY2goZnVuY3Rpb24gKGFwcCkgewogICAgICAgICAgdmFyIGlkID0gYXBwLm93bmVyLmlkOwogICAgICAgICAgcmVzdWx0LnBlclVzZXJbaWRdID0gcmVzdWx0LnBlclVzZXJbaWRdIHx8IHsgYXBwczogMCwgcGxhbnM6IDAgfTsKICAgICAgICAgIHJlc3VsdC5wZXJVc2VyW2lkXS5hcHBzICs9IDE7CiAgICAgICAgICByZXN1bHQucGVyVXNlcltpZF0ucGxhbnMgKz0gcGxhbnMuaW5kZXhPZihhcHAuYXBwSWQpID49IDAgPyAxIDogMDsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgY29uc29sZS5sb2coJ2dldEFwcHNQZXJVc2VyIGVuZCcpOwogICAgICByZXR1cm4gX2RiLmNsb3NlKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfSk7CiAgICB9KTsKICB9KTsKfTs="}},{"text":"getB4aUsers.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9wcm9taXNlID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL3Byb21pc2UnKTsKCnZhciBfcHJvbWlzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcm9taXNlKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgUmVhZFByZWZlcmVuY2UgPSByZXF1aXJlKCdtb25nb2RiJykuUmVhZFByZWZlcmVuY2U7CnZhciBkYiA9IHJlcXVpcmUoJy4uL3V0aWwvZGInKTsKdmFyIHNldHRpbmdzID0gcmVxdWlyZSgnLi4vc2V0dGluZ3MnKTsKCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLkFQUF9NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYikgewogICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdCNGFVc2VyJywgeyByZWFkUHJlZmVyZW5jZTogUmVhZFByZWZlcmVuY2UuU0VDT05EQVJZX1BSRUZFUlJFRCB9KS5maW5kKHt9LCB7IGludGVybmFsX2lkOiAxIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uICh1c2VycykgewogICAgICB2YXIgdXNlcklkcyA9IHVzZXJzLm1hcChmdW5jdGlvbiAodXNlcikgewogICAgICAgIHJldHVybiB1c2VyWydpbnRlcm5hbF9pZCddOwogICAgICB9KTsKICAgICAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuTU9OR09fVVJJKS50aGVuKGZ1bmN0aW9uIChfZGIyKSB7CiAgICAgICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgICAgICBfaWQ6IHsgJG5pbjogdXNlcklkcyB9CiAgICAgICAgfSwgewogICAgICAgICAgZW1haWw6IDEsCiAgICAgICAgICBjcmVhdGVkQXQ6IDEsCiAgICAgICAgICByZWZlcmVyOiAxLAogICAgICAgICAgZ2NsaWQ6IDEsCiAgICAgICAgICB1dG1fc291cmNlOiAxLAogICAgICAgICAgdXRtX21lZGl1bTogMSwKICAgICAgICAgIHV0bV9jYW1wYWlnbjogMSwKICAgICAgICAgIHV0bV90ZXJtOiAxLAogICAgICAgICAgdXRtX2NvbnRlbnQ6IDEKICAgICAgICB9KS50b0FycmF5KCkudGhlbihmdW5jdGlvbiAoYjRhVXNlcnMpIHsKICAgICAgICAgIC8vIHJldHVybiBiNGFVc2Vycy5tYXAoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgIC8vICAgcmV0dXJuIHVzZXJbJ2ludGVybmFsX2lkJ107CiAgICAgICAgICAvLyB9KTsKICAgICAgICAgIHJldHVybiBiNGFVc2VyczsKICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgICAgICByZXR1cm4gX2RiLmNsb3NlKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBfZGIyLmNsb3NlKCk7CiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICB9KTsKfTsKCm1vZHVsZS5leHBvcnRzLmdldEFsbEludGVybmFsVXNlcnMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuTU9OR09fVVJJKS50aGVuKGZ1bmN0aW9uIChfZGIyKSB7CiAgICByZXR1cm4gX2RiMi5jb2xsZWN0aW9uKCdVc2VyJywgeyByZWFkUHJlZmVyZW5jZTogUmVhZFByZWZlcmVuY2UuU0VDT05EQVJZX1BSRUZFUlJFRCB9KS5maW5kKCkudG9BcnJheSgpOwogIH0pOwp9OwoKbW9kdWxlLmV4cG9ydHMuZ2V0QWxsQ29ob3J0VXNlcnMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignQjRhVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCgpLnRvQXJyYXkoKTsKICB9KTsKfTsKCm1vZHVsZS5leHBvcnRzLmdldEFsbENvaG9ydFVzZXJzID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLkFQUF9NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYjIpIHsKICAgIHJldHVybiBfZGIyLmNvbGxlY3Rpb24oJ0I0YVVzZXInLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLmZpbmQoKS50b0FycmF5KCk7CiAgfSk7Cn07Cgptb2R1bGUuZXhwb3J0cy5nZXRBbGxHb29nbGVBbmFseXRjc0RhdGEgPSBmdW5jdGlvbiAoZ2NsSWRzKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignR29vZ2xlQWR3b3Jkc0RhdGEnLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLmZpbmQoeyBHY2xJZDogeyAkaW46IGdjbElkcyB9IH0sIHsgR2NsSWQ6IDEsIENhbXBhaWduSWQ6IDEsIENhbXBhaWduTmFtZTogMSB9KS50b0FycmF5KCk7CiAgfSk7Cn07Cgptb2R1bGUuZXhwb3J0cy51cGRhdGVDb2hvcnRVc2VycyA9IGZ1bmN0aW9uICh1c2VycykgewogIGlmICghdXNlcnMgfHwgIXVzZXJzLmxlbmd0aCkgcmV0dXJuIF9wcm9taXNlMi5kZWZhdWx0LnJlc29sdmUoe30pOwogIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLkFQUF9NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYjIpIHsKICAgIHZhciBjb2wgPSBfZGIyLmNvbGxlY3Rpb24oJ0I0YVVzZXInLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pOwogICAgdmFyIGJhdGNoID0gY29sLmluaXRpYWxpemVVbm9yZGVyZWRCdWxrT3AoeyB1c2VMZWdhY3lPcHM6IHRydWUgfSk7CiAgICB1c2Vycy5mb3JFYWNoKGZ1bmN0aW9uICh1KSB7CiAgICAgIGJhdGNoLmZpbmQoeyBfaWQ6IHUuX2lkIH0pLnVwZGF0ZU9uZSh7ICRzZXQ6IHUgfSk7CiAgICB9KTsKICAgIHJldHVybiBiYXRjaC5leGVjdXRlKCk7CiAgfSk7Cn07Cgptb2R1bGUuZXhwb3J0cy5nZXREaXN0aW5jdFNvdXJjZXMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignQjRhVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZGlzdGluY3QoJ3V0bV9zb3VyY2UnKTsKICB9KTsKfTsKCm1vZHVsZS5leHBvcnRzLmdldERpc3RpbmN0Q2FtcGFpZ25zID0gZnVuY3Rpb24gKCkgewogIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLkFQUF9NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYjIpIHsKICAgIHJldHVybiBfZGIyLmNvbGxlY3Rpb24oJ0I0YVVzZXInLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLmRpc3RpbmN0KCd1dG1fY2FtcGFpZ24nKTsKICB9KTsKfTsKCm1vZHVsZS5leHBvcnRzLmdldERpc3RpbmN0VGVybXMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignQjRhVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZGlzdGluY3QoJ3V0bV90ZXJtJyk7CiAgfSk7Cn07Cgptb2R1bGUuZXhwb3J0cy5nZXREaXN0aW5jdE1lZGl1bXMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignQjRhVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZGlzdGluY3QoJ3V0bV9tZWRpdW0nKTsKICB9KTsKfTsKCm1vZHVsZS5leHBvcnRzLmdldERpc3RpbmN0Q29udGVudHMgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgcmV0dXJuIF9kYjIuY29sbGVjdGlvbignQjRhVXNlcicsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZGlzdGluY3QoJ3V0bV9jb250ZW50Jyk7CiAgfSk7Cn07"}},{"text":"getCreatedApps.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIFJlYWRQcmVmZXJlbmNlID0gcmVxdWlyZSgnbW9uZ29kYicpLlJlYWRQcmVmZXJlbmNlOwoKdmFyIGRiID0gcmVxdWlyZSgnLi4vdXRpbC9kYicpOwp2YXIgcXVlcnlEYXRlcyA9IHJlcXVpcmUoJy4uL3V0aWwvcXVlcnlEYXRlcycpOwp2YXIgc2V0dGluZ3MgPSByZXF1aXJlKCcuLi9zZXR0aW5ncycpOwoKY29uc29sZS5sb2coc2V0dGluZ3MpOwoKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaWQsIF9xdWVyeSkgewogIHZhciBxdWVyeTsKICB0cnkgewogICAgcXVlcnkgPSBKU09OLnBhcnNlKF9xdWVyeSk7CiAgfSBjYXRjaCAoZSkgewogICAgcXVlcnkgPSBfcXVlcnk7CiAgfQoKICBxdWVyeSA9IHF1ZXJ5RGF0ZXMucGFyc2VRdWVyeURhdGVzKHF1ZXJ5KTsKCiAgdmFyIHJlc3BvbnNlID0geyAncXVlcnknOiBxdWVyeSB9OwoKICByZXR1cm4gZGIuZ2V0Q29ubmVjdGlvbihzZXR0aW5ncy5NT05HT19VUkkpLnRoZW4oZnVuY3Rpb24gKF9kYikgewogICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdQYXJzZUFwcCcsIHsgcmVhZFByZWZlcmVuY2U6IFJlYWRQcmVmZXJlbmNlLlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgIGNyZWF0ZWRBdDogewogICAgICAgICRndGU6IHF1ZXJ5LmJlZ2luRGF0ZSwKICAgICAgICAkbHQ6IHF1ZXJ5LmVuZERhdGUKICAgICAgfQogICAgfSkudG9BcnJheSgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgcmVzcG9uc2UuY3JlYXRlZEFwcHMgPSByZXN1bHRzLmxlbmd0aDsKICAgICAgaWYgKHF1ZXJ5LnBlclVzZXJzID09PSB0cnVlKSB7CiAgICAgICAgcmVzcG9uc2UucGVyVXNlciA9IHt9OwogICAgICAgIHJldHVybiByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24gKGFwcCkgewogICAgICAgICAgdmFyIGlkID0gYXBwLm93bmVyLmlkOwogICAgICAgICAgcmVzcG9uc2UucGVyVXNlcltpZF0gPSByZXNwb25zZS5wZXJVc2VyW2lkXSA/IHJlc3BvbnNlLnBlclVzZXJbaWRdICsgMSA6IDE7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX2RiLmNvbGxlY3Rpb24oJ1BhcnNlQXBwJykuY291bnQoewogICAgICAgIGNyZWF0ZWRBdDogeyAkbHQ6IHF1ZXJ5LmVuZERhdGUgfQogICAgICB9LCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pOwogICAgfSkudGhlbihmdW5jdGlvbiAoY291bnRUb3RhbCkgewogICAgICByZXNwb25zZS5hcHBzVG90YWxQZXJpb2QgPSBjb3VudFRvdGFsOwogICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBfZGIuY29sbGVjdGlvbignUGFyc2VBcHAnKS5jb3VudCh7fSwgeyByZWFkUHJlZmVyZW5jZTogUmVhZFByZWZlcmVuY2UuU0VDT05EQVJZX1BSRUZFUlJFRCB9KTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvdW50VG90YWwpIHsKICAgICAgcmVzcG9uc2UuYXBwc1RvdGFsID0gY291bnRUb3RhbDsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX2RiLmNsb3NlKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIFtyZXNwb25zZV07CiAgICAgIH0pOwogICAgfSk7CiAgfSkuY2F0Y2goY29uc29sZS5sb2cpOwp9Ow=="}},{"text":"getCreatedPlans.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwoKdmFyIF9tb25nb2RiID0gcmVxdWlyZSgnbW9uZ29kYicpOwoKdmFyIF9tb25nb2RiMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21vbmdvZGIpOwoKdmFyIF9kYjIgPSByZXF1aXJlKCcuLi91dGlsL2RiJyk7Cgp2YXIgZGIgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfZGIyKTsKCnZhciBfcXVlcnlEYXRlcyA9IHJlcXVpcmUoJy4uL3V0aWwvcXVlcnlEYXRlcycpOwoKdmFyIHF1ZXJ5RGF0ZXMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfcXVlcnlEYXRlcyk7Cgp2YXIgX3NldHRpbmdzID0gcmVxdWlyZSgnLi4vc2V0dGluZ3MnKTsKCnZhciBfc2V0dGluZ3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2V0dGluZ3MpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH0KCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9CgpleHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoaWQsIF9xdWVyeSkgewogIHZhciBxdWVyeTsKICB0cnkgewogICAgcXVlcnkgPSBKU09OLnBhcnNlKF9xdWVyeSk7CiAgfSBjYXRjaCAoZSkgewogICAgcXVlcnkgPSBfcXVlcnk7CiAgfQoKICBxdWVyeSA9IHF1ZXJ5RGF0ZXMucGFyc2VRdWVyeURhdGVzKHF1ZXJ5KTsKCiAgdmFyIHJlc3BvbnNlID0geyAncXVlcnknOiBxdWVyeSB9OwoKICByZXR1cm4gZGIuZ2V0Q29ubmVjdGlvbihfc2V0dGluZ3MyLmRlZmF1bHQuTU9OR09fVVJJKS50aGVuKGZ1bmN0aW9uIChfZGIpIHsKICAgIHJldHVybiBfZGIuY29sbGVjdGlvbignUGxhbicsIHsgcmVhZFByZWZlcmVuY2U6IF9tb25nb2RiMi5kZWZhdWx0LlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgIGNyZWF0ZWRBdDogeyAkZ3RlOiBxdWVyeS5iZWdpbkRhdGUsICRsdDogcXVlcnkuZW5kRGF0ZSB9LAogICAgICBjb3Vwb25JZDogbnVsbCwKICAgICAgcGxhbk5hbWU6IHsgJGV4aXN0czogdHJ1ZSwgJG5vdDogL0ZyZWUvIH0sCiAgICAgIGFwcFR5cGU6ICdwYXJzZScKICAgIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgIHJlc3BvbnNlLmNyZWF0ZWRQbGFucyA9IHJlc3VsdHMubGVuZ3RoOwogICAgICBpZiAocXVlcnkucGVyVXNlcnMgPT09IHRydWUpIHsKICAgICAgICByZXR1cm4gcmVzdWx0cy5tYXAoZnVuY3Rpb24gKHBsYW4pIHsKICAgICAgICAgIHJldHVybiBwbGFuLmFwcElkOwogICAgICAgIH0pOwogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdHMpKSB7CiAgICAgICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdQYXJzZUFwcCcsIHsgcmVhZFByZWZlcmVuY2U6IF9tb25nb2RiMi5kZWZhdWx0LlNFQ09OREFSWV9QUkVGRVJSRUQgfSkuZmluZCh7CiAgICAgICAgICBhcHBJZDogeyAkaW46IHJlc3VsdHMgfQogICAgICAgIH0pLnRvQXJyYXkoKS50aGVuKGZ1bmN0aW9uIChfcmVzdWx0cykgewogICAgICAgICAgcmVzcG9uc2UucGVyVXNlciA9IHt9OwogICAgICAgICAgcmV0dXJuIF9yZXN1bHRzLmZvckVhY2goZnVuY3Rpb24gKGFwcCkgewogICAgICAgICAgICB2YXIgaWQgPSBhcHAub3duZXIuaWQ7CiAgICAgICAgICAgIHJlc3BvbnNlLnBlclVzZXJbaWRdID0gcmVzcG9uc2UucGVyVXNlcltpZF0gPyByZXNwb25zZS5wZXJVc2VyW2lkXSArIDEgOiAxOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gX2RiLmNvbGxlY3Rpb24oJ1BsYW4nKS5jb3VudCh7CiAgICAgICAgY3JlYXRlZEF0OiB7ICRsdDogcXVlcnkuZW5kRGF0ZSB9LAogICAgICAgIGNvdXBvbklkOiBudWxsLAogICAgICAgIHBsYW5OYW1lOiB7ICRleGlzdHM6IHRydWUsICRub3Q6IC9GcmVlLyB9LAogICAgICAgIGFwcFR5cGU6ICdwYXJzZScKICAgICAgfSwgeyByZWFkUHJlZmVyZW5jZTogX21vbmdvZGIyLmRlZmF1bHQuU0VDT05EQVJZX1BSRUZFUlJFRCB9KTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvdW50VG90YWwpIHsKICAgICAgcmVzcG9uc2UucGxhbnNUb3RhbFBlcmlvZCA9IGNvdW50VG90YWw7CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdQbGFuJykuY291bnQoewogICAgICAgIGNvdXBvbklkOiBudWxsLAogICAgICAgIHBsYW5OYW1lOiB7ICRleGlzdHM6IHRydWUsICRub3Q6IC9GcmVlLyB9LAogICAgICAgIGFwcFR5cGU6ICdwYXJzZScKICAgICAgfSwgeyByZWFkUHJlZmVyZW5jZTogX21vbmdvZGIyLmRlZmF1bHQuU0VDT05EQVJZX1BSRUZFUlJFRCB9KTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvdW50VG90YWwpIHsKICAgICAgcmVzcG9uc2UucGxhbnNUb3RhbCA9IGNvdW50VG90YWw7CiAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIF9kYi5jbG9zZSgpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBbcmVzcG9uc2VdOwogICAgICB9KTsKICAgIH0pOwogIH0pLmNhdGNoKGNvbnNvbGUubG9nKTsKfTsKCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddOw=="}},{"text":"getReportDailyUser.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9yZWdlbmVyYXRvciA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3InKTsKCnZhciBfcmVnZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVnZW5lcmF0b3IpOwoKdmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yJyk7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXN5bmNUb0dlbmVyYXRvcjIpOwoKZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0KCnZhciBkYiA9IHJlcXVpcmUoJy4uL3V0aWwvZGInKTsKdmFyIHNldHRpbmdzID0gcmVxdWlyZSgnLi4vc2V0dGluZ3MnKTsKdmFyIFJlcG9ydF9EYWlseV9Vc2VyID0gJ1JlcG9ydF9EYWlseV9Vc2VyJzsKCm1vZHVsZS5leHBvcnRzLmFnZ3JlZ2F0ZURhdGFQZXJSZWZlcmVuY2VEYXRlID0gZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMy5kZWZhdWx0KSggLyojX19QVVJFX18qL19yZWdlbmVyYXRvcjIuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZGF0ZUJlZ2luLCBkYXRlRW5kLCB1c2VycykgewogICAgcmV0dXJuIF9yZWdlbmVyYXRvcjIuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGRiLmdldENvbm5lY3Rpb24oc2V0dGluZ3MuQVBQX01PTkdPX1VSSSkudGhlbihmdW5jdGlvbiAoX2RiMikgewogICAgICAgICAgICAgIHJldHVybiBfZGIyLmNvbGxlY3Rpb24oUmVwb3J0X0RhaWx5X1VzZXIpLmFnZ3JlZ2F0ZShbewogICAgICAgICAgICAgICAgJyRtYXRjaCc6IHsKICAgICAgICAgICAgICAgICAgJ3JlZmVyZW5jZV9kYXRlJzogewogICAgICAgICAgICAgICAgICAgICckZ3RlJzogZGF0ZUJlZ2luLAogICAgICAgICAgICAgICAgICAgICckbHQnOiBkYXRlRW5kCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICdfcF91c2VyJzogewogICAgICAgICAgICAgICAgICAgICckaW4nOiB1c2VycwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgIiRwcm9qZWN0IjogewogICAgICAgICAgICAgICAgICAicmVmZXJlbmNlX2RhdGUiOiAxLjAsCiAgICAgICAgICAgICAgICAgICJhY3RpdmVfYXBwcyI6IDEuMCwKICAgICAgICAgICAgICAgICAgIm5ld19wbGFucyI6IDEuMCwKICAgICAgICAgICAgICAgICAgIm5ld19hcHBzIjogMS4wLAogICAgICAgICAgICAgICAgICAiYXBwc190b3RhbCI6IDEuMCwKICAgICAgICAgICAgICAgICAgInBsYW5zX3RvdGFsIjogMS4wLAogICAgICAgICAgICAgICAgICAiYXBpX2NhbGxzIjogMS4wLAogICAgICAgICAgICAgICAgICAiYWN0aXZlX3VzZXJzIjogewogICAgICAgICAgICAgICAgICAgICIkY29uZCI6IHsKICAgICAgICAgICAgICAgICAgICAgICJpZiI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgIiRndCI6IFsiJGFjdGl2ZV9hcHBzIiwgMC4wXQogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICJ0aGVuIjogMSwKICAgICAgICAgICAgICAgICAgICAgICJlbHNlIjogMAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICIkZ3JvdXAiOiB7CiAgICAgICAgICAgICAgICAgICJfaWQiOiAiJHJlZmVyZW5jZV9kYXRlIiwKICAgICAgICAgICAgICAgICAgImFjdGl2ZV9hcHBzIjogewogICAgICAgICAgICAgICAgICAgICIkc3VtIjogIiRhY3RpdmVfYXBwcyIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgIm5ld19wbGFucyI6IHsKICAgICAgICAgICAgICAgICAgICAiJHN1bSI6ICIkbmV3X3BsYW5zIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAibmV3X2FwcHMiOiB7CiAgICAgICAgICAgICAgICAgICAgIiRzdW0iOiAiJG5ld19hcHBzIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAiYXBwc190b3RhbCI6IHsKICAgICAgICAgICAgICAgICAgICAiJHN1bSI6ICIkYXBwc190b3RhbCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgInBsYW5zX3RvdGFsIjogewogICAgICAgICAgICAgICAgICAgICIkc3VtIjogIiRwbGFuc190b3RhbCIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgImFwaV9jYWxscyI6IHsKICAgICAgICAgICAgICAgICAgICAiJHN1bSI6ICIkYXBpX2NhbGxzIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAiYWN0aXZlX3VzZXJzIjogewogICAgICAgICAgICAgICAgICAgICIkc3VtIjogIiRhY3RpdmVfdXNlcnMiCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9XSwgewogICAgICAgICAgICAgICAgImFsbG93RGlza1VzZSI6IHRydWUKICAgICAgICAgICAgICB9KS50b0FycmF5KCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgncmV0dXJuJywgX2NvbnRleHQuc2VudCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIHVuZGVmaW5lZCk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgptb2R1bGUuZXhwb3J0cy5nZXRVbm9yZGVyZWRCdWxrID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMy5kZWZhdWx0KSggLyojX19QVVJFX18qL19yZWdlbmVyYXRvcjIuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogIHZhciBfZGIsIHJlcG9ydERhaWx5VXNlcjsKCiAgcmV0dXJuIF9yZWdlbmVyYXRvcjIuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgIHdoaWxlICgxKSB7CiAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgIHJldHVybiBkYi5nZXRDb25uZWN0aW9uKHNldHRpbmdzLkFQUF9NT05HT19VUkkpOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBfZGIgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgIHJldHVybiBfZGIuY29sbGVjdGlvbihSZXBvcnRfRGFpbHlfVXNlcik7CgogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJlcG9ydERhaWx5VXNlciA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgcmV0dXJuIHJlcG9ydERhaWx5VXNlci5pbml0aWFsaXplVW5vcmRlcmVkQnVsa09wKCk7CgogICAgICAgIGNhc2UgODoKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCdyZXR1cm4nLCBfY29udGV4dDIuc2VudCk7CgogICAgICAgIGNhc2UgOToKICAgICAgICBjYXNlICdlbmQnOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LCBfY2FsbGVlMiwgdW5kZWZpbmVkKTsKfSkpOw=="}},{"text":"getStepCohort.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gc3RlcENvaG9ydFJlcG9ydChjb2hvcnRJbml0LCBjb2hvcnRFbmQsIHBlcmlvZEluaXQsIHBlcmlvZEVuZCwgc3RlcCkgewogIHZhciBSZXBvcnRfRGFpbHlfVXNlciA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ1JlcG9ydF9EYWlseV9Vc2VyJyk7CiAgdmFyIEI0YVVzZXIgPSBQYXJzZS5PYmplY3QuZXh0ZW5kKCdCNGFVc2VyJyk7CgogIGNvbnNvbGUubG9nKCdzdGVwQ29ob3J0UmVwb3J0ID0+JywgYXJndW1lbnRzKTsKCiAgY29ob3J0SW5pdCA9IG5ldyBEYXRlKGNvaG9ydEluaXQpOwogIGNvaG9ydEVuZCA9IG5ldyBEYXRlKGNvaG9ydEVuZCk7CiAgcGVyaW9kSW5pdCA9IG5ldyBEYXRlKHBlcmlvZEluaXQpOwogIHBlcmlvZEVuZCA9IG5ldyBEYXRlKHBlcmlvZEVuZCk7CgogIHZhciBjb2hvcnRSZXN1bHQgPSB7fTsKCiAgdmFyIGNvaG9ydFVzZXJzID0ge307CgogIHZhciBjdXJyZW50UGVyaW9kID0gcGVyaW9kRW5kOwoKICByZXR1cm4gaXRlcmF0aW9uVGhyb3VnaFBlcmlvZChjdXJyZW50UGVyaW9kLCBjb2hvcnRVc2VycywgY29ob3J0UmVzdWx0KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgY29uc29sZS5sb2coZS5zdGFjayk7CiAgfSk7CgogIGZ1bmN0aW9uIGl0ZXJhdGlvblRocm91Z2hQZXJpb2QoY3VycmVudFBlcmlvZCwgY29ob3J0VXNlcnMsIGNvaG9ydFJlc3VsdCkgewogICAgY29uc29sZS5sb2coJ2N1cnJlbnRQZXJpb2QnLCBkYXRlVG9TdHJpbmcoY3VycmVudFBlcmlvZCksICdwZXJpb2RJbml0JywgZGF0ZVRvU3RyaW5nKHBlcmlvZEluaXQpKTsKICAgIGlmIChjdXJyZW50UGVyaW9kID49IHBlcmlvZEluaXQpIHsKICAgICAgY29ob3J0UmVzdWx0W2RhdGVUb1N0cmluZyhjdXJyZW50UGVyaW9kKV0gPSB7fTsKICAgICAgdmFyIGN1cnJlbnRDb2hvcnQgPSBjb2hvcnRFbmQ7CiAgICAgIHJldHVybiBpdGVyYXRpb25UaHJvdWdoQ29ob3J0KGN1cnJlbnRQZXJpb2QsIGN1cnJlbnRDb2hvcnQpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGN1cnJlbnRQZXJpb2QgPSBhZGREYXkoY3VycmVudFBlcmlvZCwgLTEpOwogICAgICAgIHJldHVybiBpdGVyYXRpb25UaHJvdWdoUGVyaW9kKGN1cnJlbnRQZXJpb2QsIGNvaG9ydFVzZXJzLCBjb2hvcnRSZXN1bHQpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBQYXJzZS5Qcm9taXNlLnJlc29sdmUoY29ob3J0UmVzdWx0KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGl0ZXJhdGlvblRocm91Z2hDb2hvcnQoY3VycmVudFBlcmlvZCwgY3VycmVudENvaG9ydCkgewogICAgaWYgKGN1cnJlbnRDb2hvcnQgPj0gY29ob3J0SW5pdCkgewogICAgICByZXR1cm4gZ2V0Q29ob3J0VXNlcnMoY3VycmVudENvaG9ydCwgY29ob3J0VXNlcnMpLnRoZW4oZnVuY3Rpb24gKGNvaG9ydFVzZXJzKSB7CiAgICAgICAgaWYgKGN1cnJlbnRQZXJpb2QgPj0gY3VycmVudENvaG9ydCkgewogICAgICAgICAgcmV0dXJuIGdldEFjdGl2ZVVzZXJzKGN1cnJlbnRQZXJpb2QsIGNvaG9ydFVzZXJzW2N1cnJlbnRDb2hvcnRdKS50aGVuKGZ1bmN0aW9uIChhY3RpdmVVc2VycykgewogICAgICAgICAgICBjb2hvcnRSZXN1bHRbZGF0ZVRvU3RyaW5nKGN1cnJlbnRQZXJpb2QpXVtkYXRlVG9TdHJpbmcoY3VycmVudENvaG9ydCldID0gewogICAgICAgICAgICAgIGNvaG9ydFVzZXJzOiBjb2hvcnRVc2Vyc1tjdXJyZW50Q29ob3J0XS5sZW5ndGgsCiAgICAgICAgICAgICAgYWN0aXZlVXNlcnM6IGFjdGl2ZVVzZXJzLmxlbmd0aCwKICAgICAgICAgICAgICBwcm9wb3J0aW9uOiBNYXRoLnJvdW5kKGFjdGl2ZVVzZXJzLmxlbmd0aCAqIDEwMDAwLjAgLyAoY29ob3J0VXNlcnNbY3VycmVudENvaG9ydF0ubGVuZ3RoICogMS4wKSkgLyAxMDAwMC4wCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGN1cnJlbnRDb2hvcnQgPSBhZGREYXkoY3VycmVudENvaG9ydCwgLTEpOwogICAgICAgIHJldHVybiBpdGVyYXRpb25UaHJvdWdoQ29ob3J0KGN1cnJlbnRQZXJpb2QsIGN1cnJlbnRDb2hvcnQpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBQYXJzZS5Qcm9taXNlLnJlc29sdmUoY29ob3J0UmVzdWx0KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldENvaG9ydFVzZXJzKGN1cnJlbnRDb2hvcnQsIGNvaG9ydFVzZXJzKSB7CiAgICBpZiAoY29ob3J0VXNlcnNbY3VycmVudENvaG9ydF0pIHsKICAgICAgcmV0dXJuIFBhcnNlLlByb21pc2UucmVzb2x2ZShjb2hvcnRVc2Vycyk7CiAgICB9IGVsc2UgewogICAgICB2YXIgY3VycmVudENvaG9ydFVzZXJzID0gW107CiAgICAgIHZhciBxdWVyeV91c2VyID0gbmV3IFBhcnNlLlF1ZXJ5KEI0YVVzZXIpOwoKICAgICAgcXVlcnlfdXNlci5ncmVhdGVyVGhhbk9yRXF1YWxUbygnb3JpZ2luYWxfY3JlYXRlZF9hdCcsIGN1cnJlbnRDb2hvcnQpOwogICAgICBxdWVyeV91c2VyLmxlc3NUaGFuKCdvcmlnaW5hbF9jcmVhdGVkX2F0JywgYWRkRGF5KGN1cnJlbnRDb2hvcnQpKTsKCiAgICAgIHJldHVybiBxdWVyeV91c2VyLmVhY2goZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICBjdXJyZW50Q29ob3J0VXNlcnMucHVzaCh1c2VyKTsKICAgICAgfSwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgY29ob3J0VXNlcnNbY3VycmVudENvaG9ydF0gPSBjdXJyZW50Q29ob3J0VXNlcnM7CiAgICAgICAgcmV0dXJuIGNvaG9ydFVzZXJzOwogICAgICB9KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIGdldEFjdGl2ZVVzZXJzKGN1cnJlbnRQZXJpb2QsIGN1cnJlbnRDb2hvcnRVc2VycykgewogICAgdmFyIGFjdGl2ZVVzZXJzID0gW107CiAgICB2YXIgcXVlcnlfZGFpbHkgPSBuZXcgUGFyc2UuUXVlcnkoUmVwb3J0X0RhaWx5X1VzZXIpOwoKICAgIHF1ZXJ5X2RhaWx5LmdyZWF0ZXJUaGFuT3JFcXVhbFRvKCdyZWZlcmVuY2VfZGF0ZScsIGN1cnJlbnRQZXJpb2QpOwogICAgcXVlcnlfZGFpbHkubGVzc1RoYW4oJ3JlZmVyZW5jZV9kYXRlJywgYWRkRGF5KGN1cnJlbnRQZXJpb2QpKTsKICAgIHF1ZXJ5X2RhaWx5LmNvbnRhaW5lZEluKCd1c2VyJywgY3VycmVudENvaG9ydFVzZXJzKTsKICAgIHF1ZXJ5X2RhaWx5LmdyZWF0ZXJUaGFuKCdhcGlfY2FsbHMnLCAwKTsKICAgIHF1ZXJ5X2RhaWx5LmluY2x1ZGUoJ3VzZXInKTsKICAgIHJldHVybiBxdWVyeV9kYWlseS5lYWNoKGZ1bmN0aW9uIChhY3RpdmVVc2Vyc0RhdGEpIHsKICAgICAgdmFyIGlkID0gYWN0aXZlVXNlcnNEYXRhLmdldCgndXNlcicpLmlkOwogICAgICBpZiAoYWN0aXZlVXNlcnMuaW5kZXhPZihpZCkgPCAwKSB7CiAgICAgICAgYWN0aXZlVXNlcnMucHVzaChpZCk7CiAgICAgIH0KICAgIH0sIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gYWN0aXZlVXNlcnM7CiAgICB9KTsKICB9CgogIC8vIC0tLS0tCgogIGZ1bmN0aW9uIGRhdGVUb1N0cmluZyhpbkRhdGUpIHsKICAgIHZhciBwYWRkaW5nID0gJzAwJzsKICAgIHZhciBkYXkgPSAnJyArIGluRGF0ZS5nZXRVVENEYXRlKCk7CiAgICB2YXIgbW9udGggPSAnJyArIChpbkRhdGUuZ2V0VVRDTW9udGgoKSArIDEpOwogICAgcmV0dXJuIHBhZGRpbmcuc3Vic3RyKGRheS5sZW5ndGgpICsgZGF5ICsgJy8nICsgKHBhZGRpbmcuc3Vic3RyKG1vbnRoLmxlbmd0aCkgKyBtb250aCkgKyAnLycgKyBpbkRhdGUuZ2V0VVRDRnVsbFllYXIoKTsKICB9CgogIGZ1bmN0aW9uIGFkZERheShpbkRhdGUsIGFtb3VudCkgewogICAgaWYgKGFtb3VudCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGFtb3VudCA9IDE7CiAgICB9CgogICAgdmFyIG91dERhdGUgPSBuZXcgRGF0ZSgpOwogICAgb3V0RGF0ZS5zZXRUaW1lKGluRGF0ZS5nZXRUaW1lKCkgKyBhbW91bnQgKiBzdGVwICogMjQgKiA2MCAqIDYwICogMTAwMCk7CiAgICByZXR1cm4gb3V0RGF0ZTsKICB9Cn0KCm1vZHVsZS5leHBvcnRzID0gc3RlcENvaG9ydFJlcG9ydDs="}},{"text":"updateOldUsers.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKLy92YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7Cgp2YXIgX3JlZ2VuZXJhdG9yID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9yZWdlbmVyYXRvcicpOwoKdmFyIF9yZWdlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWdlbmVyYXRvcik7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3InKTsKCnZhciBfYXN5bmNUb0dlbmVyYXRvcjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hc3luY1RvR2VuZXJhdG9yMik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKdmFyIFJlYWRQcmVmZXJlbmNlID0gcmVxdWlyZSgnbW9uZ29kYicpLlJlYWRQcmVmZXJlbmNlOwp2YXIgcXVlcnlEYXRlcyA9IHJlcXVpcmUoJy4uL3V0aWwvcXVlcnlEYXRlcycpOwp2YXIgZGIgPSByZXF1aXJlKCcuLi91dGlsL2RiJyk7CnZhciBzZXR0aW5ncyA9IHJlcXVpcmUoJy4uL3NldHRpbmdzJyk7Cgp2YXIgdXBkYXRlVXNlcnMgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IzLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfZGIsIHVzZXJzKSB7CiAgICB2YXIgYmF0Y2g7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yMi5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGJhdGNoID0gX2RiLmNvbGxlY3Rpb24oJ0I0YVVzZXInKS5pbml0aWFsaXplVW5vcmRlcmVkQnVsa09wKHsgdXNlTGVnYWN5T3BzOiB0cnVlIH0pOwoKICAgICAgICAgICAgdXNlcnMuZm9yRWFjaChmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgICAgIGJhdGNoLmZpbmQoeyBfaWQ6IHVzZXIuX2lkLnNwbGl0KCckJykucG9wKCksIGFjdGl2YXRpb25fZGF0ZTogbnVsbCB9KS51cGRhdGVPbmUoeyAkc2V0OiB7IGFjdGl2YXRpb25fZGF0ZTogdXNlci5hY3RpdmF0aW9uX2RhdGUgfSB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gYmF0Y2guZXhlY3V0ZSgpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgJ2VuZCc6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlLCB1bmRlZmluZWQpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVVzZXJzKF94LCBfeDIpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIGdldEFjdGl2ZVVzZXJzID0gZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjMuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihfZGIpIHsKICAgIHZhciBBY3RpdmVVc2VyczsKICAgIHJldHVybiBfcmVnZW5lcmF0b3IyLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIF9kYi5jb2xsZWN0aW9uKCdhY3RpdmVfdXNlcnMnLCB7IHJlYWRQcmVmZXJlbmNlOiBSZWFkUHJlZmVyZW5jZS5TRUNPTkRBUllfUFJFRkVSUkVEIH0pLmZpbmQoKS50b0FycmF5KCk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBBY3RpdmVVc2VycyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgncmV0dXJuJywgQWN0aXZlVXNlcnMpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgJ2VuZCc6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTIsIHVuZGVmaW5lZCk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZ2V0QWN0aXZlVXNlcnMoX3gzKSB7CiAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgZ2V0REIgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYzID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMy5kZWZhdWx0KSggLyojX19QVVJFX18qL19yZWdlbmVyYXRvcjIuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgcmV0dXJuIF9yZWdlbmVyYXRvcjIuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICByZXR1cm4gZGIuZ2V0Q29ubmVjdGlvbihzZXR0aW5ncy5BUFBfTU9OR09fVVJJKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCdyZXR1cm4nLCBfY29udGV4dDMuc2VudCk7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMywgdW5kZWZpbmVkKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBnZXREQigpIHsKICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCnZhciBleGVjID0gZnVuY3Rpb24gKCkgewogIHZhciBfcmVmNCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjMuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgIHZhciBfZGIsIHVzZXJzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3IyLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGdldERCKCk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBfZGIgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA1OwogICAgICAgICAgICByZXR1cm4gZ2V0QWN0aXZlVXNlcnMoX2RiKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHVzZXJzID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZVVzZXJzKF9kYiwgdXNlcnMpOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoJ3JldHVybicsICdTVUNDRVNTJyk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNCwgdW5kZWZpbmVkKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBleGVjKCkgewogICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKaWYgKHJlcXVpcmUubWFpbiA9PT0gbW9kdWxlKSB7CiAgZXhlYygpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgY29uc29sZS5sb2cocmVzdWx0KTsKICAgIHByb2Nlc3MuZXhpdCgwKTsKICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICBwcm9jZXNzLmV4aXQoZXJyKTsKICB9KTsKfQoKbW9kdWxlLmV4cG9ydHMgPSBleGVjOw=="}}],"state":{"opened":true},"type":"folder"},{"text":"main.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9yZWdlbmVyYXRvciA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvcmVnZW5lcmF0b3InKTsKCnZhciBfcmVnZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVnZW5lcmF0b3IpOwoKdmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IHJlcXVpcmUoJ2JhYmVsLXJ1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yJyk7Cgp2YXIgX2FzeW5jVG9HZW5lcmF0b3IzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXN5bmNUb0dlbmVyYXRvcjIpOwoKdmFyIF9rZXlzID0gcmVxdWlyZSgnYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzJyk7Cgp2YXIgX2tleXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfa2V5cyk7Cgp2YXIgX3Byb21pc2UgPSByZXF1aXJlKCdiYWJlbC1ydW50aW1lL2NvcmUtanMvcHJvbWlzZScpOwoKdmFyIF9wcm9taXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Byb21pc2UpOwoKdmFyIF9zZXQgPSByZXF1aXJlKCdiYWJlbC1ydW50aW1lL2NvcmUtanMvc2V0Jyk7Cgp2YXIgX3NldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXQpOwoKcmVxdWlyZSgnLi9kYWlseUpvYnMnKTsKCnJlcXVpcmUoJy4vY2hlY2tvdXRJbnRlZ3JhdGlvbicpOwoKdmFyIF9nZXRTdGVwQ29ob3J0ID0gcmVxdWlyZSgnLi9saWIvZ2V0U3RlcENvaG9ydCcpOwoKdmFyIF9nZXRTdGVwQ29ob3J0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFN0ZXBDb2hvcnQpOwoKdmFyIF9nZXRSZXBvcnREYWlseVVzZXIgPSByZXF1aXJlKCcuL2xpYi9nZXRSZXBvcnREYWlseVVzZXInKTsKCnZhciBfZ2V0UmVwb3J0RGFpbHlVc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFJlcG9ydERhaWx5VXNlcik7CgpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQoKLyoqCiAqIENsb3VkIENvZGUgRnVuY3Rpb24KICogVGhpcyBmdW5jdGlvbiBpcyBhIGJlYXV0aWZ1bCAiSGVsbG8gV29ybGQiLgogKiBSZXNwb25zZSAiMjAwIiBpcyBjYWxsZWQgYXQgdGhlIGVuZC4KICogQGZ1bmN0aW9uIGhlbGxvCiAqIEBhbGlhcyBoZWxsbwogKiBAZXhhbXBsZSBQT1NUIC9mdW5jdGlvbnMvaGVsbG8gInt9IgogKi8KUGFyc2UuQ2xvdWQuZGVmaW5lKCdoZWxsbycsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogIHZhciByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwMCk7CiAgdmFyIGhlbGxvID0gJ3dvcmxkJzsKICByZXMuc3VjY2Vzcyh7CiAgICByYW5kb206IHJhbmRvbSwKICAgIGhlbGxvOiBoZWxsbwogIH0pOwp9KTsKClBhcnNlLkNsb3VkLmRlZmluZSgnY2FsY3VsYXRlRGFpbHlVc2VyJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgdmFyIGEgPSBuZXcgX3NldDIuZGVmYXVsdCgpOwogIGEuYWRkKDEpOwogIGNvbnNvbGUubG9nKGEpOwogIHJlcy5zdWNjZXNzKDEpOwp9KTsKClBhcnNlLkNsb3VkLmpvYigna2VlcEF3YWtlJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgdmFyIHJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDAwKTsKICByZXMuc3VjY2Vzcyh7CiAgICByYW5kb206IHJhbmRvbQogIH0pOwp9KTsKCnZhciBydW5Db2hvcnRSZXBvcnQgPSBmdW5jdGlvbiBydW5Db2hvcnRSZXBvcnQocmVxLCByZXMpIHsKICB2YXIgZGFpbHkgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjMuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IyLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IyLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoJ3JldHVybicsIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICByZXMuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICdBbGwgc2V0ISBXaGVuIHRoZSByZXBvcnQgaGFzIGRvbmUsIGEgZmlsZSB3aWxsIGJlIGF2YWlsYWJsZSBvbiB0aGUgY2xhc3MgUmVwb3J0X0xvZ3MnCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ2V0VXNlcnMnKTsKCiAgICAgICAgICAgICAgICBnZXRVc2VycygpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB2YXIgX3JlZjIgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IzLmRlZmF1bHQpKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yMi5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh1c2VycykgewogICAgICAgICAgICAgICAgICAgIHZhciBtZXJnZSwgdXNlcnNXaXRoUHJlZml4LCBkYXRlQmVnaW4sIGRhdGVFbmQsIHF1ZXJ5X2RhaWx5LCBxdWVyeV9zdWJzY3JpcHRpb247CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvcjIuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kZWQnLCB1c2Vycy5sZW5ndGgsICd1c2VycycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2UgPSB7fTsKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMubWFwKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSB1c2VyLnRvSlNPTigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmZXJlbmNlX2RhdGUgPSBuZXcgRGF0ZSh1c2VyLm9yaWdpbmFsX2NyZWF0ZWRfYXQuaXNvKS5nZXRGdWxsWWVhcigpICsgJy0nICsgKG5ldyBEYXRlKHVzZXIub3JpZ2luYWxfY3JlYXRlZF9hdC5pc28pLmdldE1vbnRoKCkgKyAxIDwgMTAgPyAnMCcgKyAobmV3IERhdGUodXNlci5vcmlnaW5hbF9jcmVhdGVkX2F0LmlzbykuZ2V0TW9udGgoKSArIDEpIDogbmV3IERhdGUodXNlci5vcmlnaW5hbF9jcmVhdGVkX2F0LmlzbykuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgKG5ldyBEYXRlKHVzZXIub3JpZ2luYWxfY3JlYXRlZF9hdC5pc28pLmdldERhdGUoKSA8IDEwID8gJzAnICsgbmV3IERhdGUodXNlci5vcmlnaW5hbF9jcmVhdGVkX2F0LmlzbykuZ2V0RGF0ZSgpIDogbmV3IERhdGUodXNlci5vcmlnaW5hbF9jcmVhdGVkX2F0LmlzbykuZ2V0RGF0ZSgpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXcgRGF0ZShyZWZlcmVuY2VfZGF0ZSkgPj0gbmV3IERhdGUocmVxLnBhcmFtcy5iZWdpbikgJiYgbmV3IERhdGUocmVmZXJlbmNlX2RhdGUpIDw9IG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA6IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5yZWZlcmVuY2VfZGF0ZSA9IHJlZmVyZW5jZV9kYXRlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfdXNlcnMgPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X3VzZXJzID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld191c2VycyArIDEgOiAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRSZXBvcnREYWlseScpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJzV2l0aFByZWZpeCA9IHVzZXJzLm1hcChmdW5jdGlvbiAodXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlci5jbGFzc05hbWUgKyAnJCcgKyB1c2VyLmlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlQmVnaW4gPSBuZXcgRGF0ZShyZXEucGFyYW1zLmJlZ2luKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVFbmQgPSBuZXcgRGF0ZShuZXcgRGF0ZShyZXEucGFyYW1zLmVuZCkuc2V0RGF0ZShuZXcgRGF0ZShyZXEucGFyYW1zLmVuZCkuZ2V0RGF0ZSgpICsgMSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2dldFJlcG9ydERhaWx5VXNlcjIuZGVmYXVsdC5hZ2dyZWdhdGVEYXRhUGVyUmVmZXJlbmNlRGF0ZShkYXRlQmVnaW4sIGRhdGVFbmQsIHVzZXJzV2l0aFByZWZpeCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5X2RhaWx5ID0gX2NvbnRleHQuc2VudDsKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlfZGFpbHkuZm9yRWFjaChmdW5jdGlvbiAoZGFpbHkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZmVyZW5jZV9kYXRlID0gbmV3IERhdGUoZGFpbHkuX2lkKS5nZXRGdWxsWWVhcigpICsgJy0nICsgKG5ldyBEYXRlKGRhaWx5Ll9pZCkuZ2V0TW9udGgoKSArIDEgPCAxMCA/ICcwJyArIChuZXcgRGF0ZShkYWlseS5faWQpLmdldE1vbnRoKCkgKyAxKSA6IG5ldyBEYXRlKGRhaWx5Ll9pZCkuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgKG5ldyBEYXRlKGRhaWx5Ll9pZCkuZ2V0RGF0ZSgpIDwgMTAgPyAnMCcgKyBuZXcgRGF0ZShkYWlseS5faWQpLmdldERhdGUoKSA6IG5ldyBEYXRlKGRhaWx5Ll9pZCkuZ2V0RGF0ZSgpKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA6IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ucmVmZXJlbmNlX2RhdGUgPSByZWZlcmVuY2VfZGF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19hcHBzID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19hcHBzID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19hcHBzICsgZGFpbHkubmV3X2FwcHMgOiBkYWlseS5uZXdfYXBwczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFjdGl2ZV9hcHBzID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFjdGl2ZV9hcHBzID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFjdGl2ZV9hcHBzICsgZGFpbHkuYWN0aXZlX2FwcHMgOiBkYWlseS5hY3RpdmVfYXBwczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFwcHNfdG90YWwgPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uYXBwc190b3RhbCA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5hcHBzX3RvdGFsICsgZGFpbHkuYXBwc190b3RhbCA6IGRhaWx5LmFwcHNfdG90YWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcGxhbnMgPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X3BsYW5zID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19wbGFucyArIGRhaWx5Lm5ld19wbGFucyA6IGRhaWx5Lm5ld19wbGFuczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnBsYW5zX3RvdGFsID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnBsYW5zX3RvdGFsID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnBsYW5zX3RvdGFsICsgZGFpbHkucGxhbnNfdG90YWwgOiBkYWlseS5wbGFuc190b3RhbDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFjdGl2ZV91c2VycyA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5hY3RpdmVfdXNlcnMgPyBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uYWN0aXZlX3VzZXJzICsgZGFpbHkuYWN0aXZlX3VzZXJzIDogZGFpbHkuYWN0aXZlX3VzZXJzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uYXBpX2NhbGxzID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFwaV9jYWxscyA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5hcGlfY2FsbHMgKyBkYWlseS5hcGlfY2FsbHMgOiBkYWlseS5hcGlfY2FsbHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeV9zdWJzY3JpcHRpb24gPSBuZXcgUGFyc2UuUXVlcnkoU3Vic2NyaXB0aW9uKTsKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmNvbnRhaW5lZEluKCd1c2VyJywgdXNlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmdyZWF0ZXJUaGFuT3JFcXVhbFRvKCdpbml0aWFsX2RhdGUnLCBuZXcgRGF0ZShyZXEucGFyYW1zLmJlZ2luKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeV9zdWJzY3JpcHRpb24ubGVzc1RoYW4oJ2luaXRpYWxfZGF0ZScsIG5ldyBEYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5zZXREYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5nZXREYXRlKCkgKyAxKSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXRTdWJzY3JpcHRpb25zJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmVhY2goZnVuY3Rpb24gKG9iamVjdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9KU09OKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmZXJlbmNlX2RhdGUgPSBuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0RnVsbFllYXIoKSArICctJyArIChuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEgPCAxMCA/ICcwJyArIChuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpIDogbmV3IERhdGUob2JqZWN0LmluaXRpYWxfZGF0ZS5pc28pLmdldE1vbnRoKCkgKyAxKSArICctJyArIChuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0RGF0ZSgpIDwgMTAgPyAnMCcgKyBuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0RGF0ZSgpIDogbmV3IERhdGUob2JqZWN0LmluaXRpYWxfZGF0ZS5pc28pLmdldERhdGUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA6IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ucmVmZXJlbmNlX2RhdGUgPSByZWZlcmVuY2VfZGF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19zdWJzY3JpcHRpb25zID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19zdWJzY3JpcHRpb25zID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19zdWJzY3JpcHRpb25zICsgMSA6IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSArIG9iamVjdC52YWx1ZSA6IG9iamVjdC52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcnlfY2h1cm4gPSBuZXcgUGFyc2UuUXVlcnkoU3Vic2NyaXB0aW9uKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5X2NodXJuLmNvbnRhaW5lZEluKCd1c2VyJywgdXNlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeV9jaHVybi5ncmVhdGVyVGhhbk9yRXF1YWxUbygnZW5kX2RhdGUnLCBuZXcgRGF0ZShyZXEucGFyYW1zLmJlZ2luKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5X2NodXJuLmxlc3NUaGFuKCdlbmRfZGF0ZScsIG5ldyBEYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5zZXREYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5nZXREYXRlKCkgKyAxKSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dldENodXJucycpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlfY2h1cm4uZWFjaChmdW5jdGlvbiAob2JqZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gb2JqZWN0LnRvSlNPTigpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmZXJlbmNlX2RhdGUgPSBuZXcgRGF0ZShvYmplY3QuZW5kX2RhdGUuaXNvKS5nZXRGdWxsWWVhcigpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5lbmRfZGF0ZS5pc28pLmdldE1vbnRoKCkgKyAxIDwgMTAgPyAnMCcgKyAobmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpIDogbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5lbmRfZGF0ZS5pc28pLmdldERhdGUoKSA8IDEwID8gJzAnICsgbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0RGF0ZSgpIDogbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0RGF0ZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0gPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0gPyBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0gOiB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ucmVmZXJlbmNlX2RhdGUgPSByZWZlcmVuY2VfZGF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X2NodXJucyA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfY2h1cm5zID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19jaHVybnMgKyAxIDogMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uY2h1cm5zX3JldmVudWUgPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uY2h1cm5zX3JldmVudWUgPyBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uY2h1cm5zX3JldmVudWUgKyBvYmplY3QudmFsdWUgOiBvYmplY3QudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmRlcl9tZXJnZSA9ICgwLCBfa2V5czIuZGVmYXVsdCkobWVyZ2UpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShhKSAtIG5ldyBEYXRlKGIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JkZXIgPSBbJ3JlZmVyZW5jZV9kYXRlJywgJ25ld191c2VycycsICd1c2Vyc190b3RhbCcsICdhY3RpdmVfdXNlcnMnLCAnbmV3X2FwcHMnLCAnYXBwc190b3RhbCcsICdhY3RpdmVfYXBwcycsICdhcGlfY2FsbHMnLCAnbmV3X3BsYW5zJywgJ3BsYW5zX3RvdGFsJywgJ25ld19zdWJzY3JpcHRpb25zJywgJ3N1YnNjcmlwdGlvbnNfdG90YWwnLCAnbmV3X2NodXJucycsICdjaHVybnNfdG90YWwnLCAnbmV3X3JldmVudWUnLCAnY2h1cm5zX3JldmVudWUnLCAncmV2ZW51ZV90b3RhbCddOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3YgPSBvcmRlci50b1N0cmluZygpICsgJyxcbic7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2Vyc190b3RhbCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnNfdG90YWwgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZlbnVlX3RvdGFsID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1cm5zX3RvdGFsID0gMDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ21lcmdlQWxsJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyX21lcmdlLm1hcChmdW5jdGlvbiAoZGF0ZV92YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnNfdG90YWwgKz0gbWVyZ2VbZGF0ZV92YWx1ZV0ubmV3X3VzZXJzIHx8IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXJnZVtkYXRlX3ZhbHVlXS51c2Vyc190b3RhbCA9IHVzZXJzX3RvdGFsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uc190b3RhbCArPSBtZXJnZVtkYXRlX3ZhbHVlXS5uZXdfc3Vic2NyaXB0aW9ucyB8fCAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbZGF0ZV92YWx1ZV0uc3Vic2NyaXB0aW9uc190b3RhbCA9IHN1YnNjcmlwdGlvbnNfdG90YWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVybnNfdG90YWwgKz0gbWVyZ2VbZGF0ZV92YWx1ZV0ubmV3X2NodXJucyB8fCAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbZGF0ZV92YWx1ZV0uY2h1cm5zX3RvdGFsID0gY2h1cm5zX3RvdGFsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZW51ZV90b3RhbCArPSBtZXJnZVtkYXRlX3ZhbHVlXS5uZXdfcmV2ZW51ZSB8fCAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZW51ZV90b3RhbCAtPSBtZXJnZVtkYXRlX3ZhbHVlXS5jaHVybnNfcmV2ZW51ZSB8fCAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVyZ2VbZGF0ZV92YWx1ZV0ucmV2ZW51ZV90b3RhbCA9IHJldmVudWVfdG90YWw7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIubWFwKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3YgKz0gKG1lcmdlW2RhdGVfdmFsdWVdW3ZhbHVlXSB8fCAnMCcpICsgJywnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3YgKz0gJ1xuJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjc3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLnN0YWNrKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmVycm9yKGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5kJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlLCBfdGhpcyk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0oKSkuY2F0Y2goY29uc29sZS5lcnJvcik7CiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICdlbmQnOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiBkYWlseSgpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpOwoKICB2YXIgUmVwb3J0X0RhaWx5ID0gUGFyc2UuT2JqZWN0LmV4dGVuZCgnUmVwb3J0X0RhaWx5X0dlbmVyYWwnKTsKICB2YXIgQjRhVXNlciA9IFBhcnNlLk9iamVjdC5leHRlbmQoJ0I0YVVzZXInKTsKICB2YXIgU3Vic2NyaXB0aW9uID0gUGFyc2UuT2JqZWN0LmV4dGVuZCgnU3Vic2NyaXB0aW9uJyk7CgogIHZhciBjc3YgPSB2b2lkIDA7CgogIGlmICghcmVxLnBhcmFtc1snY29ob3J0LWJlZ2luJ10gJiYgIXJlcS5wYXJhbXNbJ2NvaG9ydC1lbmQnXSkgewogICAgZ2VuZXJhbCgpLnRoZW4oY29udmVydCkudGhlbihjcmVhdGVGaWxlKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgIGNvbnNvbGUubG9nKGVyci5zdGFjayk7CiAgICAgIHJldHVybiByZXMuZXJyb3IoZXJyKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBkYWlseSgpLnRoZW4oY29udmVydCkudGhlbihjcmVhdGVGaWxlKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgIGNvbnNvbGUubG9nKGVyci5zdGFjayk7CiAgICAgIHJldHVybiByZXMuZXJyb3IoZXJyKTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gZ2VuZXJhbCgpIHsKICAgIHJldHVybiBuZXcgX3Byb21pc2UyLmRlZmF1bHQoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgcXVlcnkgPSBuZXcgUGFyc2UuUXVlcnkoUmVwb3J0X0RhaWx5KTsKICAgICAgdmFyIG1lcmdlID0ge307CgogICAgICByZXMuc3VjY2Vzcyh7CiAgICAgICAgc3VjY2VzczogJ0FsbCBzZXQhIFdoZW4gdGhlIHJlcG9ydCBoYXMgZG9uZSwgYSBmaWxlIHdpbGwgYmUgYXZhaWxhYmxlIG9uIHRoZSBjbGFzcyBSZXBvcnRfTG9ncycKICAgICAgfSk7CgogICAgICBxdWVyeS5ncmVhdGVyVGhhbk9yRXF1YWxUbygncmVmZXJlbmNlX2RhdGUnLCBuZXcgRGF0ZShyZXEucGFyYW1zLmJlZ2luKSk7CiAgICAgIHF1ZXJ5Lmxlc3NUaGFuKCdyZWZlcmVuY2VfZGF0ZScsIG5ldyBEYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5zZXREYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5nZXREYXRlKCkgKyAxKSkpOwoKICAgICAgcXVlcnkuZWFjaChmdW5jdGlvbiAob2JqZWN0KSB7CiAgICAgICAgb2JqZWN0ID0gb2JqZWN0LnRvSlNPTigpOwogICAgICAgIHZhciByZWZlcmVuY2VfZGF0ZSA9IG5ldyBEYXRlKG9iamVjdC5yZWZlcmVuY2VfZGF0ZS5pc28pLmdldEZ1bGxZZWFyKCkgKyAnLScgKyAobmV3IERhdGUob2JqZWN0LnJlZmVyZW5jZV9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEgPCAxMCA/ICcwJyArIChuZXcgRGF0ZShvYmplY3QucmVmZXJlbmNlX2RhdGUuaXNvKS5nZXRNb250aCgpICsgMSkgOiBuZXcgRGF0ZShvYmplY3QucmVmZXJlbmNlX2RhdGUuaXNvKS5nZXRNb250aCgpICsgMSkgKyAnLScgKyAobmV3IERhdGUob2JqZWN0LnJlZmVyZW5jZV9kYXRlLmlzbykuZ2V0RGF0ZSgpIDwgMTAgPyAnMCcgKyBuZXcgRGF0ZShvYmplY3QucmVmZXJlbmNlX2RhdGUuaXNvKS5nZXREYXRlKCkgOiBuZXcgRGF0ZShvYmplY3QucmVmZXJlbmNlX2RhdGUuaXNvKS5nZXREYXRlKCkpOwoKICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0gPSB7fTsKCiAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnJlZmVyZW5jZV9kYXRlID0gcmVmZXJlbmNlX2RhdGU7CiAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19hcHBzID0gb2JqZWN0Lm5ld19hcHBzIHx8IDA7CiAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmFwcHNfdG90YWwgPSBvYmplY3QuYXBwc190b3RhbCB8fCAwOwogICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5hY3RpdmVfYXBwcyA9IG9iamVjdC5hY3RpdmVfYXBwcyB8fCAwOwogICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5zZXNzaW9ucyA9IG9iamVjdC5zZXNzaW9ucyB8fCAwOwogICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfdXNlcnMgPSBvYmplY3QubmV3X3VzZXJzIHx8IDA7CiAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnVzZXJzX3RvdGFsID0gb2JqZWN0LnVzZXJzX3RvdGFsIHx8IDA7CiAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19wbGFucyA9IG9iamVjdC5uZXdfcGxhbnMgfHwgMDsKICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ucGxhbnNfdG90YWwgPSBvYmplY3QucGxhbnNfdG90YWwgfHwgMDsKICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0uYWN0aXZlX3VzZXJzID0gb2JqZWN0LmFjdGl2ZV91c2VycyB8fCAwOwogICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5hcGlfY2FsbHMgPSBvYmplY3QuYXBpX2NhbGxzIHx8IDA7CiAgICAgIH0sIHsgdXNlTWFzdGVyS2V5OiB0cnVlIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBxdWVyeV9zdWJzY3JpcHRpb24gPSBuZXcgUGFyc2UuUXVlcnkoU3Vic2NyaXB0aW9uKTsKCiAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmdyZWF0ZXJUaGFuT3JFcXVhbFRvKCdpbml0aWFsX2RhdGUnLCBuZXcgRGF0ZShyZXEucGFyYW1zLmJlZ2luKSk7CiAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmxlc3NUaGFuKCdpbml0aWFsX2RhdGUnLCBuZXcgRGF0ZShuZXcgRGF0ZShyZXEucGFyYW1zLmVuZCkuc2V0RGF0ZShuZXcgRGF0ZShyZXEucGFyYW1zLmVuZCkuZ2V0RGF0ZSgpICsgMSkpKTsKCiAgICAgICAgcXVlcnlfc3Vic2NyaXB0aW9uLmVhY2goZnVuY3Rpb24gKG9iamVjdCkgewogICAgICAgICAgb2JqZWN0ID0gb2JqZWN0LnRvSlNPTigpOwoKICAgICAgICAgIHZhciByZWZlcmVuY2VfZGF0ZSA9IG5ldyBEYXRlKG9iamVjdC5pbml0aWFsX2RhdGUuaXNvKS5nZXRGdWxsWWVhcigpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5pbml0aWFsX2RhdGUuaXNvKS5nZXRNb250aCgpICsgMSA8IDEwID8gJzAnICsgKG5ldyBEYXRlKG9iamVjdC5pbml0aWFsX2RhdGUuaXNvKS5nZXRNb250aCgpICsgMSkgOiBuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5pbml0aWFsX2RhdGUuaXNvKS5nZXREYXRlKCkgPCAxMCA/ICcwJyArIG5ldyBEYXRlKG9iamVjdC5pbml0aWFsX2RhdGUuaXNvKS5nZXREYXRlKCkgOiBuZXcgRGF0ZShvYmplY3QuaW5pdGlhbF9kYXRlLmlzbykuZ2V0RGF0ZSgpKTsKICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXSA6IHt9OwogICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLnJlZmVyZW5jZV9kYXRlID0gcmVmZXJlbmNlX2RhdGU7CiAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X3N1YnNjcmlwdGlvbnMgPSBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X3N1YnNjcmlwdGlvbnMgPyBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X3N1YnNjcmlwdGlvbnMgKyAxIDogMTsKICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSA/IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfcmV2ZW51ZSArIG9iamVjdC52YWx1ZSA6IG9iamVjdC52YWx1ZTsKICAgICAgICB9LCB7IHVzZU1hc3RlcktleTogdHJ1ZSB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBxdWVyeV9jaHVybiA9IG5ldyBQYXJzZS5RdWVyeShTdWJzY3JpcHRpb24pOwoKICAgICAgICAgIHF1ZXJ5X2NodXJuLmdyZWF0ZXJUaGFuT3JFcXVhbFRvKCdlbmRfZGF0ZScsIG5ldyBEYXRlKHJlcS5wYXJhbXMuYmVnaW4pKTsKICAgICAgICAgIHF1ZXJ5X2NodXJuLmxlc3NUaGFuKCdlbmRfZGF0ZScsIG5ldyBEYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5zZXREYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXMuZW5kKS5nZXREYXRlKCkgKyAxKSkpOwoKICAgICAgICAgIHF1ZXJ5X2NodXJuLmVhY2goZnVuY3Rpb24gKG9iamVjdCkgewogICAgICAgICAgICBvYmplY3QgPSBvYmplY3QudG9KU09OKCk7CgogICAgICAgICAgICB2YXIgcmVmZXJlbmNlX2RhdGUgPSBuZXcgRGF0ZShvYmplY3QuZW5kX2RhdGUuaXNvKS5nZXRGdWxsWWVhcigpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5lbmRfZGF0ZS5pc28pLmdldE1vbnRoKCkgKyAxIDwgMTAgPyAnMCcgKyAobmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpIDogbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0TW9udGgoKSArIDEpICsgJy0nICsgKG5ldyBEYXRlKG9iamVjdC5lbmRfZGF0ZS5pc28pLmdldERhdGUoKSA8IDEwID8gJzAnICsgbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0RGF0ZSgpIDogbmV3IERhdGUob2JqZWN0LmVuZF9kYXRlLmlzbykuZ2V0RGF0ZSgpKTsKICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdIDoge307CiAgICAgICAgICAgIG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5yZWZlcmVuY2VfZGF0ZSA9IHJlZmVyZW5jZV9kYXRlOwogICAgICAgICAgICBtZXJnZVtyZWZlcmVuY2VfZGF0ZV0ubmV3X2NodXJucyA9IG1lcmdlW3JlZmVyZW5jZV9kYXRlXS5uZXdfY2h1cm5zID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLm5ld19jaHVybnMgKyAxIDogMTsKICAgICAgICAgICAgbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmNodXJuc19yZXZlbnVlID0gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmNodXJuc19yZXZlbnVlID8gbWVyZ2VbcmVmZXJlbmNlX2RhdGVdLmNodXJuc19yZXZlbnVlICsgb2JqZWN0LnZhbHVlIDogb2JqZWN0LnZhbHVlOwogICAgICAgICAgfSwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSkudGhlbihmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICB2YXIgb3JkZXJfbWVyZ2UgPSAoMCwgX2tleXMyLmRlZmF1bHQpKG1lcmdlKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGEpIC0gbmV3IERhdGUoYik7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmFyIG9yZGVyID0gWydyZWZlcmVuY2VfZGF0ZScsICdzZXNzaW9ucycsICduZXdfdXNlcnMnLCAndXNlcnNfdG90YWwnLCAnYWN0aXZlX3VzZXJzJywgJ25ld19hcHBzJywgJ2FwcHNfdG90YWwnLCAnYWN0aXZlX2FwcHMnLCAnYXBpX2NhbGxzJywgJ25ld19wbGFucycsICdwbGFuc190b3RhbCcsICduZXdfc3Vic2NyaXB0aW9ucycsICdzdWJzY3JpcHRpb25zX3RvdGFsJywgJ25ld19jaHVybnMnLCAnY2h1cm5zX3RvdGFsJywgJ25ld19yZXZlbnVlJywgJ2NodXJuc19yZXZlbnVlJywgJ3JldmVudWVfdG90YWwnXTsKCiAgICAgICAgICAgIGNzdiA9IG9yZGVyLnRvU3RyaW5nKCkgKyAnLFxuJzsKCiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25zX3RvdGFsID0gMCwKICAgICAgICAgICAgICAgIHJldmVudWVfdG90YWwgPSAwLAogICAgICAgICAgICAgICAgY2h1cm5zX3RvdGFsID0gMDsKCiAgICAgICAgICAgIG9yZGVyX21lcmdlLm1hcChmdW5jdGlvbiAoZGF0ZV92YWx1ZSkgewogICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnNfdG90YWwgKz0gbWVyZ2VbZGF0ZV92YWx1ZV0ubmV3X3N1YnNjcmlwdGlvbnMgfHwgMDsKICAgICAgICAgICAgICBtZXJnZVtkYXRlX3ZhbHVlXS5zdWJzY3JpcHRpb25zX3RvdGFsID0gc3Vic2NyaXB0aW9uc190b3RhbDsKICAgICAgICAgICAgICBjaHVybnNfdG90YWwgKz0gbWVyZ2VbZGF0ZV92YWx1ZV0ubmV3X2NodXJucyB8fCAwOwogICAgICAgICAgICAgIG1lcmdlW2RhdGVfdmFsdWVdLmNodXJuc190b3RhbCA9IGNodXJuc190b3RhbDsKICAgICAgICAgICAgICByZXZlbnVlX3RvdGFsICs9IG1lcmdlW2RhdGVfdmFsdWVdLm5ld19yZXZlbnVlIHx8IDA7CiAgICAgICAgICAgICAgcmV2ZW51ZV90b3RhbCAtPSBtZXJnZVtkYXRlX3ZhbHVlXS5jaHVybnNfcmV2ZW51ZSB8fCAwOwogICAgICAgICAgICAgIG1lcmdlW2RhdGVfdmFsdWVdLnJldmVudWVfdG90YWwgPSByZXZlbnVlX3RvdGFsOwogICAgICAgICAgICAgIG9yZGVyLm1hcChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgICAgIGNzdiArPSAobWVyZ2VbZGF0ZV92YWx1ZV1bdmFsdWVdIHx8ICcwJykgKyAnLCc7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgY3N2ICs9ICdcbic7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmVzb2x2ZShjc3YpOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIuc3RhY2spOwogICAgICAgICAgICByZXR1cm4gcmVzLmVycm9yKGVycik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGNvbnZlcnQoY3N2KSB7CiAgICB2YXIgYXJyID0gW107CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNzdi5sZW5ndGg7IGkrKykgewogICAgICBhcnIucHVzaChjc3YuY2hhckNvZGVBdChpKSk7CiAgICB9CiAgICByZXR1cm4gYXJyOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlRmlsZShhcnIpIHsKICAgIHZhciBmaWxlID0gbmV3IFBhcnNlLkZpbGUoJ2V4cG9ydC5jc3YnLCBhcnIpOwogICAgY29uc29sZS5sb2coJ2NyZWF0ZUZpbGUnKTsKICAgIGZpbGUuc2F2ZSh7IHVzZU1hc3RlcktleTogdHJ1ZSB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIFJlcG9ydF9Mb2dzID0gbmV3IFBhcnNlLk9iamVjdCgnUmVwb3J0X0xvZ3MnKTsKICAgICAgUmVwb3J0X0xvZ3Muc2V0KCdiZWdpbicsIHJlcS5wYXJhbXMuYmVnaW4pOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ2VuZCcsIHJlcS5wYXJhbXMuZW5kKTsKICAgICAgUmVwb3J0X0xvZ3Muc2V0KCdzb3VyY2UnLCByZXEucGFyYW1zLnJlZmVyZXIgfHwgJycpOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ3JlZmVyZXInLCByZXEucGFyYW1zLnJlZmVyZXIgfHwgJycpOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ3V0bV9zb3VyY2UnLCByZXEucGFyYW1zLnV0bV9zb3VyY2UgfHwgJycpOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ3V0bV9jYW1wYWlnbicsIHJlcS5wYXJhbXMudXRtX2NhbXBhaWduIHx8ICcnKTsKICAgICAgUmVwb3J0X0xvZ3Muc2V0KCd1dG1fdGVybScsIHJlcS5wYXJhbXMudXRtX3Rlcm0gfHwgJycpOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ3V0bV9tZWRpdW0nLCByZXEucGFyYW1zLnV0bV9tZWRpdW0gfHwgJycpOwogICAgICBSZXBvcnRfTG9ncy5zZXQoJ3V0bV9jb250ZW50JywgcmVxLnBhcmFtcy51dG1fY29udGVudCB8fCAnJyk7CiAgICAgIFJlcG9ydF9Mb2dzLnNldCgnYWR3b3JkcycsIHJlcS5wYXJhbXMuYWR3b3JkcyB8fCAnbm8tZmlsdGVyJyk7CiAgICAgIFJlcG9ydF9Mb2dzLnNldCgnY29ob3J0QmVnaW4nLCByZXEucGFyYW1zWydjb2hvcnQtYmVnaW4nXSB8fCAnJyk7CiAgICAgIFJlcG9ydF9Mb2dzLnNldCgnY29ob3J0RW5kJywgcmVxLnBhcmFtc1snY29ob3J0LWVuZCddIHx8ICcnKTsKICAgICAgUmVwb3J0X0xvZ3Muc2V0KCdleHBvcnQnLCBmaWxlKTsKICAgICAgcmV0dXJuIFJlcG9ydF9Mb2dzLnNhdmUobnVsbCwgeyB1c2VNYXN0ZXJLZXk6IHRydWUgfSk7CiAgICB9KS5jYXRjaChjb25zb2xlLmVycm9yKTsKICB9CgogIGZ1bmN0aW9uIGdldFVzZXJzKCkgewogICAgcmV0dXJuIG5ldyBfcHJvbWlzZTIuZGVmYXVsdChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdldFVzZXJzUmVjdXJzaXZlbHkoMCwgW10sIHJlc29sdmUpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBnZXRVc2Vyc1JlY3Vyc2l2ZWx5KCkgewogICAgdmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7CiAgICB2YXIgdXNlcnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFtdOwogICAgdmFyIHJlc29sdmUgPSBhcmd1bWVudHNbMl07CgogICAgdmFyIHF1ZXJ5ID0gbmV3IFBhcnNlLlF1ZXJ5KEI0YVVzZXIpOwogICAgdmFyIHBhY2luZyA9IDUwMDsKCiAgICBxdWVyeS5ncmVhdGVyVGhhbk9yRXF1YWxUbygnb3JpZ2luYWxfY3JlYXRlZF9hdCcsIG5ldyBEYXRlKHJlcS5wYXJhbXNbJ2NvaG9ydC1iZWdpbiddKSk7CiAgICBxdWVyeS5sZXNzVGhhbignb3JpZ2luYWxfY3JlYXRlZF9hdCcsIG5ldyBEYXRlKG5ldyBEYXRlKHJlcS5wYXJhbXNbJ2NvaG9ydC1lbmQnXSkuc2V0RGF0ZShuZXcgRGF0ZShyZXEucGFyYW1zWydjb2hvcnQtZW5kJ10pLmdldERhdGUoKSArIDEpKSk7CgogICAgaWYgKHJlcS5wYXJhbXMuYWR3b3JkcyA9PT0gJ3BhaWQnKSB7CiAgICAgIHF1ZXJ5LmV4aXN0cygnYWR3b3JkcycpOwogICAgfSBlbHNlIGlmIChyZXEucGFyYW1zLmFkd29yZHMgPT09ICdvcmdhbmljJykgewogICAgICBxdWVyeS5kb2VzTm90RXhpc3QoJ2Fkd29yZHMnKTsKICAgIH0KCiAgICBpZiAocmVxLnBhcmFtcy51dG1fc291cmNlKSBxdWVyeS5lcXVhbFRvKCd1dG1fc291cmNlJywgcmVxLnBhcmFtcy51dG1fc291cmNlID09PSAnTk9ORScgPyBudWxsIDogcmVxLnBhcmFtcy51dG1fc291cmNlKTsKICAgIGlmIChyZXEucGFyYW1zLnV0bV9jYW1wYWlnbikgcXVlcnkuZXF1YWxUbygndXRtX2NhbXBhaWduJywgcmVxLnBhcmFtcy51dG1fY2FtcGFpZ24gPT09ICdOT05FJyA/IG51bGwgOiByZXEucGFyYW1zLnV0bV9jYW1wYWlnbik7CiAgICBpZiAocmVxLnBhcmFtcy51dG1fdGVybSkgcXVlcnkuZXF1YWxUbygndXRtX3Rlcm0nLCByZXEucGFyYW1zLnV0bV90ZXJtID09PSAnTk9ORScgPyBudWxsIDogcmVxLnBhcmFtcy51dG1fdGVybSk7CiAgICBpZiAocmVxLnBhcmFtcy51dG1fbWVkaXVtKSBxdWVyeS5lcXVhbFRvKCd1dG1fbWVkaXVtJywgcmVxLnBhcmFtcy51dG1fbWVkaXVtID09PSAnTk9ORScgPyBudWxsIDogcmVxLnBhcmFtcy51dG1fbWVkaXVtKTsKICAgIGlmIChyZXEucGFyYW1zLnV0bV9jb250ZW50KSBxdWVyeS5lcXVhbFRvKCd1dG1fY29udGVudCcsIHJlcS5wYXJhbXMudXRtX2NvbnRlbnQgPT09ICdOT05FJyA/IG51bGwgOiByZXEucGFyYW1zLnV0bV9jb250ZW50KTsKCiAgICBpZiAocmVxLnBhcmFtcy5yZWZlcmVyKSB7CiAgICAgIHF1ZXJ5Lm1hdGNoZXMoJ3JlZmVyZXInLCBuZXcgUmVnRXhwKHJlcS5wYXJhbXMucmVmZXJlcikpOwogICAgfQoKICAgIHF1ZXJ5LmxpbWl0KHBhY2luZyk7CiAgICBxdWVyeS5za2lwKHBhY2luZyAqIGkpOwoKICAgIHF1ZXJ5LmZpbmQoewogICAgICB1c2VNYXN0ZXJLZXk6IHRydWUKICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHsKICAgICAgcmVzdWx0cy5tYXAoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICB1c2Vycy5wdXNoKHVzZXIpOwogICAgICB9KTsKICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoIDwgcGFjaW5nKSB7CiAgICAgICAgcmVzb2x2ZSh1c2Vycyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaSArPSAxOwogICAgICAgIHJldHVybiBnZXRVc2Vyc1JlY3Vyc2l2ZWx5KGksIHVzZXJzLCByZXNvbHZlKTsKICAgICAgfQogICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7CiAgfQp9OwoKUGFyc2UuQ2xvdWQuZGVmaW5lKCdyZXBvcnQnLCBydW5Db2hvcnRSZXBvcnQpOwoKbW9kdWxlLmV4cG9ydHMucnVuQ29ob3J0UmVwb3J0ID0gcnVuQ29ob3J0UmVwb3J0OwoKdmFyIHN0ZXBDb2hvcnQgPSBmdW5jdGlvbiBzdGVwQ29ob3J0KHJlcSwgcmVzKSB7CiAgdHJ5IHsKICAgIHZhciBjb2hvcnRJbml0ID0gcmVxLnBhcmFtc1snY29ob3J0LWJlZ2luJ10sCiAgICAgICAgY29ob3J0RW5kID0gcmVxLnBhcmFtc1snY29ob3J0LWVuZCddLAogICAgICAgIHBlcmlvZEluaXQgPSByZXEucGFyYW1zWydwZXJpb2QtYmVnaW4nXSwKICAgICAgICBwZXJpb2RFbmQgPSByZXEucGFyYW1zWydwZXJpb2QtZW5kJ10sCiAgICAgICAgc3RlcCA9IHJlcS5wYXJhbXNbJ3N0ZXAnXTsKICAgIGlmICghY29ob3J0RW5kKSB7CiAgICAgIGNvaG9ydEVuZCA9IG5ldyBEYXRlKCk7CiAgICAgIGNvaG9ydEVuZC5zZXRIb3VycygwKTsKICAgICAgY29ob3J0RW5kLnNldE1pbnV0ZXMoMCk7CiAgICAgIGNvaG9ydEVuZC5zZXRTZWNvbmRzKDApOwogICAgICBjb2hvcnRFbmQuc2V0TWlsbGlzZWNvbmRzKDApOwogICAgICBjb2hvcnRFbmQuc2V0SG91cnMoLTI0KTsKICAgIH0gZWxzZSB7CiAgICAgIGNvaG9ydEVuZCA9IG5ldyBEYXRlKGNvaG9ydEVuZCk7CiAgICB9CiAgICBpZiAoIWNvaG9ydEluaXQpIHsKICAgICAgY29ob3J0SW5pdCA9IG5ldyBEYXRlKGNvaG9ydEVuZCk7CiAgICAgIGNvaG9ydEluaXQuc2V0SG91cnMoLTI0ICogMjcpOwogICAgfSBlbHNlIHsKICAgICAgY29ob3J0SW5pdCA9IG5ldyBEYXRlKGNvaG9ydEluaXQpOwogICAgfQogICAgaWYgKCFwZXJpb2RJbml0KSB7CiAgICAgIHBlcmlvZEluaXQgPSBuZXcgRGF0ZShjb2hvcnRJbml0KTsKICAgIH0gZWxzZSB7CiAgICAgIHBlcmlvZEluaXQgPSBuZXcgRGF0ZShwZXJpb2RJbml0KTsKICAgIH0KICAgIGlmICghcGVyaW9kRW5kKSB7CiAgICAgIHBlcmlvZEVuZCA9IG5ldyBEYXRlKGNvaG9ydEVuZCk7CiAgICB9IGVsc2UgewogICAgICBwZXJpb2RFbmQgPSBuZXcgRGF0ZShwZXJpb2RFbmQpOwogICAgfQogICAgaWYgKCFzdGVwKSB7CiAgICAgIHN0ZXAgPSA3OwogICAgfQogICAgaWYgKGNvaG9ydEVuZCA8IGNvaG9ydEluaXQgfHwgcGVyaW9kRW5kIDwgcGVyaW9kSW5pdCkgewogICAgICByZXR1cm4gcmVzLmVycm9yKCdFbmQgbXVzdCBiZSBncmVhdGVyIHRoYW4gSW5pdCcpOwogICAgfQogICAgKDAsIF9nZXRTdGVwQ29ob3J0Mi5kZWZhdWx0KShjb2hvcnRJbml0LCBjb2hvcnRFbmQsIHBlcmlvZEluaXQsIHBlcmlvZEVuZCwgc3RlcCkudGhlbihmdW5jdGlvbiAocmVwb3J0KSB7CiAgICAgIHJlcy5zdWNjZXNzKHJlcG9ydCk7CiAgICB9KTsKICB9IGNhdGNoIChlKSB7CiAgICByZXMuZXJyb3IoZSk7CiAgfQp9OwoKbW9kdWxlLmV4cG9ydHMuc3RlcENvaG9ydCA9IHN0ZXBDb2hvcnQ7CgpQYXJzZS5DbG91ZC5kZWZpbmUoJ3N0ZXBDb2hvcnQnLCBzdGVwQ29ob3J0KTs="}},{"text":"package.json","data":{"code":"data:plain/text;base64,ewogICJkZXBlbmRlbmNpZXMiOiB7CiAgICAiYmFiZWwtcnVudGltZSI6ICJeNi4yNi4wIiwKICAgICJjbyI6ICJeNC42LjAiLAogICAgIm5vZGUtYWR3b3JkcyI6ICJeMjAxODAyLjEuMCIsCiAgICAibW9tZW50IjogIl4yLjIxLjAiLAogICAgImdvb2dsZWFwaXMiOiAiXjIwLjAuMSIsCiAgICAiY3N2dG9qc29uIjogIl4xLjEuOSIKICB9Cn0K"}},{"text":"settings.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIF9jbGFzc0NhbGxDaGVjazIgPSByZXF1aXJlKCdiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2snKTsKCnZhciBfY2xhc3NDYWxsQ2hlY2szID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xhc3NDYWxsQ2hlY2syKTsKCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9Cgp2YXIgV3JhcHBlciA9IGZ1bmN0aW9uIFdyYXBwZXIoKSB7CiAgKDAsIF9jbGFzc0NhbGxDaGVjazMuZGVmYXVsdCkodGhpcywgV3JhcHBlcik7CgogIHRoaXMuUEFSU0VfQVBQU19NT05HT19VUkkgPSAnbnVsbCc7CiAgdGhpcy5NT05HT19VUkkgPSAnbnVsbCc7CiAgdmFyIHNldHRpbmdzID0gdGhpczsKICBQYXJzZS5Db25maWcuZ2V0KCkudGhlbihmdW5jdGlvbiAoY29uZmlnKSB7CiAgICBzZXR0aW5ncy5QQVJTRV9BUFBTX01PTkdPX1VSSSA9IGNvbmZpZy5nZXQoJ1BBUlNFX0FQUFNfTU9OR09fVVJJJyk7CiAgICBzZXR0aW5ncy5NT05HT19VUkkgPSBjb25maWcuZ2V0KCdNT05HT19VUkknKTsKICAgIHNldHRpbmdzLkFQUF9NT05HT19VUkkgPSBjb25maWcuZ2V0KCdBUFBfTU9OR09fVVJJJyk7CiAgICBzZXR0aW5ncy5DSEVDS09VVF9NT05HT19VUkkgPSBjb25maWcuZ2V0KCdDSEVDS09VVF9NT05HT19VUkknKTsKICAgIHNldHRpbmdzLkNIRUNLT1VUX0FQUF9JRCA9IGNvbmZpZy5nZXQoJ0NIRUNLT1VUX0FQUF9JRCcpOwogICAgc2V0dGluZ3MuQ0hFQ0tPVVRfTUFTVEVSX0tFWSA9IGNvbmZpZy5nZXQoJ0NIRUNLT1VUX01BU1RFUl9LRVknKTsKICB9KTsKfTsKCnZhciB0ZXN0VmFycyA9IHsKICBBUFBfTU9OR09fVVJJOiAnbW9uZ29kYjovL2xvY2FsaG9zdC9jb2hvcnQnLAogIENIRUNLT1VUX0FQUF9JRDogJ200WkpQV0hFNjkyQXJrQnNiOVA5ZU5hNHREbFJOZGlkRWRQUGVkWlknLAogIENIRUNLT1VUX01BU1RFUl9LRVk6ICdEUmEzbTc2dUFCTEszblplWkpKdDR0ZnFhZW80azZjYkl6N1paUTZDJywKICBDSEVDS09VVF9NT05HT19VUkk6ICdtb25nb2RiOi8vYWRtaW46YXF0bDRma1JzN1lFQmRZZ1JxSGxLbFl3QG1vbmdvZGI3LmJhY2s0YXBwLmNvbToyNzAxNy8wYmI5YzBiZDdhZGM0ZDUyYTYwM2I3OWIzZGFhNDMyNC0yJywKICBNT05HT19VUkk6ICdtb25nb2RiOi8vbG9jYWxob3N0L2JhY2s0YXBwJywKICBQQVJTRV9BUFBTX01PTkdPX1VSSTogJ21vbmdvZGI6Ly9sb2NhbGhvc3QvYmFjazRhcHAnCn07Cgptb2R1bGUuZXhwb3J0cyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcgPyB0ZXN0VmFycyA6IG5ldyBXcmFwcGVyKCk7"}},{"text":"util","children":[{"text":"checkout.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIHNldHRpbmdzID0gcmVxdWlyZSgnLi4vc2V0dGluZ3MnKTsKCm1vZHVsZS5leHBvcnRzID0ge307Cgptb2R1bGUuZXhwb3J0cy5nZXRQbGFucyA9IGZ1bmN0aW9uICgpIHsKICB2YXIgYXBwSWQgPSB2b2lkIDAsCiAgICAgIG1hc3RlcktleSA9IHZvaWQgMDsKICBhcHBJZCA9IHNldHRpbmdzLkNIRUNLT1VUX0FQUF9JRDsKICBtYXN0ZXJLZXkgPSBzZXR0aW5ncy5DSEVDS09VVF9NQVNURVJfS0VZOwogIHJldHVybiBQYXJzZS5DbG91ZC5odHRwUmVxdWVzdCh7CiAgICBtZXRob2Q6ICdHRVQnLAogICAgdXJsOiAnaHR0cHM6Ly9jaGVja291dC5iYWNrNGFwcC5pby9jbGFzc2VzL1BsYW4nLAogICAgaGVhZGVyczogewogICAgICAnWC1QYXJzZS1BcHBsaWNhdGlvbi1JZCc6IGFwcElkLAogICAgICAnWC1QYXJzZS1NYXN0ZXItS2V5JzogbWFzdGVyS2V5CiAgICB9CiAgfSkudGhlbihmdW5jdGlvbiAoaHR0cFJlc3BvbnNlKSB7CiAgICB2YXIgZGF0YSA9IHt9OwogICAgaHR0cFJlc3BvbnNlLmRhdGEucmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGFuKSB7CiAgICAgIGRhdGFbcGxhbi5uYW1lXSA9IHBsYW4uYW1vdW50OwogICAgfSk7CiAgICByZXR1cm4gZGF0YTsKICB9LCBmdW5jdGlvbiAoZSkgewogICAgY29uc29sZS5sb2coZSk7CiAgfSk7Cn07"}},{"text":"db.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKdmFyIE1vbmdvQ2xpZW50ID0gcmVxdWlyZSgnbW9uZ29kYicpLk1vbmdvQ2xpZW50Owp2YXIgc2V0dGluZ3MgPSByZXF1aXJlKCcuLi9zZXR0aW5ncycpOwoKY29uc29sZS5sb2coc2V0dGluZ3MpOwoKZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbihtb25nb1VSSSkgewogIHJldHVybiBNb25nb0NsaWVudC5jb25uZWN0KG1vbmdvVVJJIHx8IHNldHRpbmdzLlBBUlNFX0FQUFNfTU9OR09fVVJJKS50aGVuKGZ1bmN0aW9uIChfZGIpIHsKICAgIHJldHVybiBfZGI7CiAgfSk7Cn0KCmZ1bmN0aW9uIGdldERiKGRiTmFtZSkgewogIHJldHVybiBnZXRDb25uZWN0aW9uKCkudGhlbihmdW5jdGlvbiAoX2RiKSB7CiAgICByZXR1cm4gX2RiLmRiKGRiTmFtZSk7CiAgfSk7Cn0KCm1vZHVsZS5leHBvcnRzID0ge307Cm1vZHVsZS5leHBvcnRzLmdldENvbm5lY3Rpb24gPSBnZXRDb25uZWN0aW9uOwptb2R1bGUuZXhwb3J0cy5nZXREYiA9IGdldERiOw=="}},{"text":"queryDates.js","data":{"code":"data:plain/text;base64,J3VzZSBzdHJpY3QnOwoKbW9kdWxlLmV4cG9ydHMgPSB7fTsKbW9kdWxlLmV4cG9ydHMucGFyc2VEYXRlID0gcGFyc2VEYXRlOwptb2R1bGUuZXhwb3J0cy5wYXJzZVF1ZXJ5RGF0ZXMgPSBwYXJzZVF1ZXJ5RGF0ZXM7Cm1vZHVsZS5leHBvcnRzLmdldEZvcm1hdCA9IGdldEZvcm1hdDsKbW9kdWxlLmV4cG9ydHMuZ2V0RGF0ZVN0cmluZyA9IGdldERhdGVTdHJpbmc7CgpmdW5jdGlvbiBnZXRGb3JtYXQoKSB7CiAgcmV0dXJuICdZWVlZTU1ERGhobW0nOwp9CgpmdW5jdGlvbiBwYXJzZVF1ZXJ5RGF0ZXMocXVlcnlPYmopIHsKICBpZiAocXVlcnlPYmouZW5kRGF0ZSkgewogICAgcXVlcnlPYmouZW5kRGF0ZSA9IHBhcnNlRGF0ZShxdWVyeU9iai5lbmREYXRlKTsKICB9IGVsc2UgewogICAgcXVlcnlPYmouZW5kRGF0ZSA9IG5ldyBEYXRlKCk7CiAgICBxdWVyeU9iai5lbmREYXRlLnNldEhvdXJzKDApOwogICAgcXVlcnlPYmouZW5kRGF0ZS5zZXRNaW51dGVzKDApOwogICAgcXVlcnlPYmouZW5kRGF0ZS5zZXRTZWNvbmRzKDApOwogICAgcXVlcnlPYmouZW5kRGF0ZS5zZXRNaWxsaXNlY29uZHMoMCk7CiAgICBxdWVyeU9iai5lbmREYXRlLnNldEhvdXJzKC0yNCk7CiAgfQogIGlmIChxdWVyeU9iai5iZWdpbkRhdGUpIHsKICAgIHF1ZXJ5T2JqLmJlZ2luRGF0ZSA9IHBhcnNlRGF0ZShxdWVyeU9iai5iZWdpbkRhdGUpOwogIH0gZWxzZSB7CiAgICBxdWVyeU9iai5iZWdpbkRhdGUgPSBuZXcgRGF0ZShxdWVyeU9iai5lbmREYXRlKTsKICAgIHF1ZXJ5T2JqLmJlZ2luRGF0ZS5zZXRIb3VycygtMjQpOwogIH0KICByZXR1cm4gcXVlcnlPYmo7Cn0KCmZ1bmN0aW9uIHBhcnNlRGF0ZShzdHJpbmcpIHsKICB2YXIgeWVhciA9IHN0cmluZy5zdWJzdHIoMCwgNCk7CiAgdmFyIG1vbnRoID0gTnVtYmVyKHN0cmluZy5zdWJzdHIoNCwgMikgfHwgMSkgLSAxOwogIHZhciBkYXkgPSBzdHJpbmcuc3Vic3RyKDYsIDIpOwogIHZhciBob3VyID0gc3RyaW5nLnN1YnN0cig4LCAyKTsKICB2YXIgbWludXRlID0gc3RyaW5nLnN1YnN0cigxMCwgMik7CiAgcmV0dXJuIG5ldyBEYXRlKHllYXIgfHwgMjAxNywgbW9udGggfHwgMCwgZGF5IHx8IDEsIGhvdXIgfHwgMCwgbWludXRlIHx8IDApOwp9CgpmdW5jdGlvbiBnZXREYXRlU3RyaW5nKGRhdGUsIHllc3RlcmRheSkgewogIGlmICh5ZXN0ZXJkYXkpIGRhdGUuc2V0SG91cnMoLTI0KTsKICB2YXIgZGF0ZVN0cmluZyA9ICcnOwogIGRhdGVTdHJpbmcgKz0gZGF0ZS5nZXRVVENGdWxsWWVhcigpOwogIHZhciBtb250aCA9IGRhdGUuZ2V0VVRDTW9udGgoKSArIDE7CiAgZGF0ZVN0cmluZyArPSBtb250aCA+PSAxMCA/IG1vbnRoIDogJzAnICsgbW9udGg7CiAgdmFyIGRheSA9IGRhdGUuZ2V0VVRDRGF0ZSgpOwogIGRhdGVTdHJpbmcgKz0gZGF5ID49IDEwID8gZGF5IDogJzAnICsgZGF5OwogIHJldHVybiBkYXRlU3RyaW5nOwp9"}}],"state":{"opened":true},"type":"folder"},{"text":"views","children":[{"text":"index.ejs","data":{"code":"data:plain/text;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sPgoKPGhlYWQ+CiAgICA8dGl0bGU+Q29ob3J0IFJlcG9ydDwvdGl0bGU+CjwvaGVhZD4KCjxib2R5Pgo8aDE+Q29ob3J0IFJlcG9ydDwvaDE+Cjxmb3JtIGFjdGlvbj0iL3JlcG9ydCIgbWV0aG9kPSJnZXQiPgogICAgUmVmZXJlcjoKICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJyZWZlcmVyIj4KCiAgICA8YnI+CiAgICA8YnI+IEFkd29yZHM6CiAgICA8c2VsZWN0IG5hbWU9ImFkd29yZHMiPgogICAgICAgIDxvcHRpb24gdmFsdWU9Im9yZ2FuaWMiPk9yZ2FuaWM8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJwYWlkIj5QYWlkPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibm8tZmlsdGVyIj5Oby1maWx0ZXI8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgPGJyPgogICAgPGJyPiBQZXJpb2QgQmVnaW46CiAgICA8aW5wdXQgdHlwZT0iZGF0ZSIgbmFtZT0iYmVnaW4iIHJlcXVpcmVkPiBQZXJpb2QgRW5kOgogICAgPGlucHV0IHR5cGU9ImRhdGUiIG5hbWU9ImVuZCIgcmVxdWlyZWQ+CiAgICA8YnI+CiAgICA8YnI+IENvaG9ydCBCZWdpbjoKICAgIDxpbnB1dCB0eXBlPSJkYXRlIiBuYW1lPSJjb2hvcnQtYmVnaW4iPiBDb2hvcnQgRW5kOgogICAgPGlucHV0IHR5cGU9ImRhdGUiIG5hbWU9ImNvaG9ydC1lbmQiPgogICAgPGJyPgogICAgPGJyPiB1dG1fc291cmNlOgogICAgPHNlbGVjdCBuYW1lPSJ1dG1fc291cmNlIj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPkFsbDwvb3B0aW9uPgogICAgICAgIDxvcHRpb24gdmFsdWU9Ik5PTkUiPk5vIHNvdXJjZTwvb3B0aW9uPgogICAgICAgIDwlIHV0bV9zb3VyY2VzLmZvckVhY2goZnVuY3Rpb24odXRtX3NvdXJjZSkgeyAlPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI8JT0gdXRtX3NvdXJjZSAlPiI+PCU9IHV0bV9zb3VyY2UgJT48L29wdGlvbj4KICAgICAgICA8JSB9KTsgJT4KICAgIDwvc2VsZWN0PgogICAgPGJyPgogICAgPGJyPiB1dG1fY2FtcGFpZ246CiAgICA8c2VsZWN0IG5hbWU9InV0bV9jYW1wYWlnbiI+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5BbGw8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJOT05FIj5ObyBjYW1wYWlnbjwvb3B0aW9uPgogICAgICAgIDwlIHV0bV9jYW1wYWlnbnMuZm9yRWFjaChmdW5jdGlvbih1dG1fY2FtcGFpZ24pIHsgJT4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iPCU9IHV0bV9jYW1wYWlnbiAlPiI+PCU9IHV0bV9jYW1wYWlnbiAlPjwvb3B0aW9uPgogICAgICAgIDwlIH0pOyAlPgogICAgPC9zZWxlY3Q+CiAgICA8YnI+CiAgICA8YnI+IHV0bV90ZXJtOgogICAgPHNlbGVjdCBuYW1lPSJ1dG1fdGVybSI+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5BbGw8L29wdGlvbj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSJOT05FIj5ObyB0ZXJtPC9vcHRpb24+CiAgICAgICAgPCUgdXRtX3Rlcm1zLmZvckVhY2goZnVuY3Rpb24odXRtX3Rlcm0pIHsgJT4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iPCU9IHV0bV90ZXJtICU+Ij48JT0gdXRtX3Rlcm0gJT48L29wdGlvbj4KICAgICAgICA8JSB9KTsgJT4KICAgIDwvc2VsZWN0PgogICAgPGJyPgogICAgPGJyPiB1dG1fbWVkaXVtOgogICAgPHNlbGVjdCBuYW1lPSJ1dG1fbWVkaXVtIj4KICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPkFsbDwvb3B0aW9uPgogICAgICAgIDxvcHRpb24gdmFsdWU9Ik5PTkUiPk5vIG1lZGl1bTwvb3B0aW9uPgogICAgICAgIDwlIHV0bV9tZWRpdW1zLmZvckVhY2goZnVuY3Rpb24odXRtX21lZGl1bSkgeyAlPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI8JT0gdXRtX21lZGl1bSAlPiI+PCU9IHV0bV9tZWRpdW0gJT48L29wdGlvbj4KICAgICAgICA8JSB9KTsgJT4KICAgIDwvc2VsZWN0PgogICAgPGJyPgogICAgPGJyPiB1dG1fY29udGVudDoKICAgIDxzZWxlY3QgbmFtZT0idXRtX2NvbnRlbnQiPgogICAgICAgIDxvcHRpb24gdmFsdWU9IiI+QWxsPC9vcHRpb24+CiAgICAgICAgPG9wdGlvbiB2YWx1ZT0iTk9ORSI+Tm8gY29udGVudDwvb3B0aW9uPgogICAgICAgIDwlIHV0bV9jb250ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHV0bV9jb250ZW50KSB7ICU+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjwlPSB1dG1fY29udGVudCAlPiI+PCU9IHV0bV9jb250ZW50ICU+PC9vcHRpb24+CiAgICAgICAgPCUgfSk7ICU+CiAgICA8L3NlbGVjdD4KICAgIDxicj4KICAgIDxidXR0b24gdHlwZT0ic3VibWl0Ij5TdWJtaXQ8L2J1dHRvbj4KPC9mb3JtPgo8L2JvZHk+Cgo8L2h0bWw+Cg=="}}],"state":{"opened":true},"type":"folder"}]},{"text":"public","state":{"opened":true},"type":"folder","children":[{"text":"index.html","data":{"code":"data:plain/text;base64,CjxodG1sPgogIDxoZWFkPgogICAgPHRpdGxlPk15IFBhcnNlQXBwIHNpdGU8L3RpdGxlPgogICAgPHN0eWxlPgogICAgYm9keSB7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyB9CiAgICBkaXYgeyB3aWR0aDogODAwcHg7IGhlaWdodDogNDAwcHg7IG1hcmdpbjogNDBweCBhdXRvOyBwYWRkaW5nOiAyMHB4OyBib3JkZXI6IDJweCBzb2xpZCAjNTI5OGZjOyB9CiAgICBoMSB7IGZvbnQtc2l6ZTogMzBweDsgbWFyZ2luOiAwOyB9CiAgICBwIHsgbWFyZ2luOiA0MHB4IDA7IH0KICAgIGVtIHsgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsgfQogICAgYSB7IGNvbG9yOiAjNTI5OGZjOyB0ZXh0LWRlY29yYXRpb246IG5vbmU7IH0KICAgIDwvc3R5bGU+CiAgPC9oZWFkPgogIDxib2R5PgogICAgPGRpdj4KICAgICAgPGgxPkNvbmdyYXR1bGF0aW9ucyEgWW91J3JlIGFscmVhZHkgaG9zdGluZyB3aXRoIFBhcnNlLjwvaDE+CiAgICAgIDxwPlRvIGdldCBzdGFydGVkLCBlZGl0IHRoaXMgZmlsZSBhdCA8ZW0+cHVibGljL2luZGV4Lmh0bWw8L2VtPiBhbmQgc3RhcnQgYWRkaW5nIHN0YXRpYyBjb250ZW50LjwvcD4KICAgICAgPHA+SWYgeW91IHdhbnQgc29tZXRoaW5nIGEgYml0IG1vcmUgZHluYW1pYywgZGVsZXRlIHRoaXMgZmlsZSBhbmQgY2hlY2sgb3V0IDxhIGhyZWY9Imh0dHBzOi8vcGFyc2UuY29tL2RvY3MvaG9zdGluZ19ndWlkZSN3ZWJhcHAiPm91ciBob3N0aW5nIGRvY3M8L2E+LjwvcD4KICAgIDwvZGl2PgogIDwvYm9keT4KPC9odG1sPgo="}}]}]}

const create = (data, file) => {
  let inst = $.jstree.reference(data),
    obj = inst.get_node(data);
  if (!file) {
    inst.create_node(obj, {
      type: 'new-folder',
      text: 'New Folder',
      state: { opened: true }
    });
  } else {
    inst.create_node(obj, {
      type: 'new-file',
      text: file.text.name,
      data: file.data
    });
  }
}

const remove = (data) => {
  let inst = $.jstree.reference(data)
  let obj = inst.get_node(data);
  if (inst.is_selected(obj)) {
    inst.delete_node(inst.get_selected());
  } else {
    inst.delete_node(obj);
  }
}

const decodeFile = code => {
  try {
    if (code) {
      let encodedCode = code.split(',')[1]
      let decodedCode = atob(encodedCode)
      code = decodedCode
    }
  } catch (err) {
    console.error(err)
  }
  return code
}

const readFile = (file, newTreeNodes) => {
  file.code = decodeFile(file.code)
  newTreeNodes.push({
    text: file.name,
    data: {
      code: file.code
    }
  })
  return newTreeNodes
}

const verifyFileNames = (data, newTreeNodes) => {
  let inst = $.jstree.reference(data)
  let currentCode = inst.get_node(data);
  console.log(currentCode)
  for (let i = 0; i < currentCode.length; i++) {
    for (let j = 0; j < newTreeNodes.length; j++) {
      if (currentCode[i].text === newTreeNodes[j].text) {
        if (alert.confirm(newTreeNodes[j].text +
            ' file already exists. Do you want to overwrite?')) {
          currentCode.splice(i, 1);
        } else {
          newTreeNodes.splice(j, 1);
        }
      }
    }
  }
}

const addFilesOnTree = (files, currentCode) => {
  let newTreeNodes = [];
  for (let i = 0; i < files.fileList.length; i++) {
    newTreeNodes = readFile({ name: files.fileList[i], code: files.base64[i] }, newTreeNodes);
  }
  let re = /(?:\.([^.]+))?$/, ext;
  verifyFileNames(currentCode, newTreeNodes);
  for (let i = 0; i < newTreeNodes.length; i++) {
    ext = re.exec(newTreeNodes[i].text)[1];
    console.log(ext)
    if (currentCode === '#') {
      let inst = $.jstree.reference(currentCode)
      let obj = inst.get_node(currentCode);
      if (ext === 'js')
        currentCode += obj.children[0]
      else currentCode += obj.children[1]
    }
    create(currentCode, newTreeNodes[i])
  }
  return currentCode;
}

const customMenu = node => {
  // The default set of all items
  let items = $.jstree.defaults.contextmenu.items();
  items.create.action = function (data) {
    create(data.reference)
  };
  items.remove.action = function (data) {
    remove(data.reference)
  };
  delete items.ccp;
  if (node.type === 'default' || node.type === 'new-file') {
    delete items.create;
    delete items.rename;
  }
  if (node.text === 'cloud' && node.parent === '#') {
    delete items.remove;
    delete items.rename;
    delete items.ccp;
  }
  if (node.text === 'public' && node.parent === '#') {
    delete items.remove;
    delete items.rename;
    delete items.ccp;
  }
  return items;
}

const iterateOverFolders = folder => {
  if (folder.type === 'folder') folder.children.forEach(iterateOverFolders)
  if (folder.data && folder.data.code) folder.data.code = decodeFile(folder.data.code)
}

const getData = () => {
  source.tree.forEach(iterateOverFolders)
  console.log('source.tree', source.tree)
  return source.tree
}

const getConfig = () => {
  return {
    plugins: ['contextmenu', 'dnd', 'sort', 'types', 'unique', 'changed'],
    core: {
      "check_callback": true,
      'data': getData()
    },
    contextmenu: {items: customMenu},
    types: {
      '#': {
        max_children: 2
      },
      default: {
        icon: 'zmdi zmdi-file',
        max_children: 0
      },
      folder: {
        icon: 'zmdi zmdi-folder',
        max_depth: 10,
        max_children: 100
      },
      "new-folder": {
        icon: 'zmdi zmdi-folder new',
        max_depth: 10,
        max_children: 100
      },
      "new-file": {
        icon: 'zmdi zmdi-file new',
        max_children: 0
      }
    }
  }
}

module.exports = {
  getData,
  getConfig,
  remove,
  addFilesOnTree,
  readFile
}
